"use strict";(self.webpackChunkuploader=self.webpackChunkuploader||[]).push([[74],{4074:(gn,ae,h)=>{h.r(ae),h.d(ae,{MainModule:()=>un});var q=h(3271),v=h(6991),l=h(5620),Me=h(61),Te=h(7462),Pe=h(4987),k=h(3287),e=h(5e3);let Le=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main"]],decls:2,vars:0,consts:[[1,"container-fluid","mb-5","mt-3"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"router-outlet"),e.qZA())},directives:[k.lC],styles:[""]}),t})();var j=h(5698);const le=(0,l.PH)("[Upload/UI] attach a file",(0,l.Ky)()),ce=(0,l.PH)("[Upload/UI] Remove all attached files"),K=(0,l.PH)("[Upload/API] Upload file start",(0,l.Ky)()),X=(0,l.PH)("[Upload/API] Upload file successful",(0,l.Ky)()),de=(0,l.PH)("[Upload/API] Upload file failed",(0,l.Ky)()),V=(0,l.PH)("[Upload/API] Upload file progress update",(0,l.Ky)()),ee=(0,l.PH)("[Upload/API] Update new photo in user DB start",(0,l.Ky)()),te=(0,l.PH)("[Upload/API] Update new photo in user DB successful",(0,l.Ky)()),pe=(0,l.PH)("[Upload/API] Update new photo in user DB failed",(0,l.Ky)()),Y=(0,l.PH)("[Upload/API] Get user files start",(0,l.Ky)()),ue=(0,l.PH)("[Upload/API] Get user files successful",(0,l.Ky)()),Re=(0,l.PH)("[Upload/API] Get user files failed",(0,l.Ky)()),fe=(0,l.PH)("[Upload/API] User is not logged in to fetch files"),ge="uploadFiles",me="userFiles";var f=(()=>{return(t=f||(f={}))[t.EntitiesOnly=0]="EntitiesOnly",t[t.Both=1]="Both",t[t.None=2]="None",f;var t})();function _(t){return function(n,i){const r={ids:[...i.ids],entities:Object.assign({},i.entities)},s=t(n,r);return s===f.Both?Object.assign({},i,r):s===f.EntitiesOnly?Object.assign(Object.assign({},i),{entities:r.entities}):i}}function E(t,o){const n=o(t);return(0,e.X6Q)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",o.toString()),n}function he(t){function o(m,d){const c=E(m,t);return c in d.entities?f.None:(d.ids.push(c),d.entities[c]=m,f.Both)}function n(m,d){let c=!1;for(const a of m)c=o(a,d)!==f.None||c;return c?f.Both:f.None}function r(m,d){const c=E(m,t);return c in d.entities?(d.entities[c]=m,f.EntitiesOnly):(d.ids.push(c),d.entities[c]=m,f.Both)}function U(m,d){const a=(m instanceof Array?m:d.ids.filter(u=>m(d.entities[u]))).filter(u=>u in d.entities).map(u=>delete d.entities[u]).length>0;return a&&(d.ids=d.ids.filter(u=>u in d.entities)),a?f.Both:f.None}function F(m,d){return T([m],d)}function T(m,d){const c={};return(m=m.filter(u=>u.id in d.entities)).length>0?m.filter(g=>function w(m,d,c){const u=Object.assign({},c.entities[d.id],d.changes),g=E(u,t),y=g!==d.id;return y&&(m[d.id]=g,delete c.entities[d.id]),c.entities[g]=u,y}(c,g,d)).length>0?(d.ids=d.ids.map(g=>c[g]||g),f.Both):f.EntitiesOnly:f.None}function b(m,d){const c=[],a=[];for(const y of m){const O=E(y,t);O in d.entities?a.push({id:O,changes:y}):c.push(y)}const u=T(a,d),g=n(c,d);switch(!0){case g===f.None&&u===f.None:return f.None;case g===f.Both||u===f.Both:return f.Both;default:return f.EntitiesOnly}}return{removeAll:function M(m){return Object.assign({},m,{ids:[],entities:{}})},addOne:_(o),addMany:_(n),setAll:_(function i(m,d){return d.ids=[],d.entities={},n(m,d),f.Both}),setOne:_(r),setMany:_(function s(m,d){const c=m.map(a=>r(a,d));switch(!0){case c.some(a=>a===f.Both):return f.Both;case c.some(a=>a===f.EntitiesOnly):return f.EntitiesOnly;default:return f.None}}),updateOne:_(F),updateMany:_(T),upsertOne:_(function A(m,d){return b([m],d)}),upsertMany:_(b),removeOne:_(function p(m,d){return U([m],d)}),removeMany:_(U),map:_(function S(m,d){return T(d.ids.reduce((u,g)=>{const y=m(d.entities[g]);return y!==d.entities[g]&&u.push({id:g,changes:y}),u},[]).filter(({id:u})=>u in d.entities),d)}),mapOne:_(function z({map:m,id:d},c){const a=c.entities[d];return a?F({id:d,changes:m(a)},c):f.None})}}function ye(t={}){var o,n;const{selectId:i,sortComparer:r}={selectId:null!==(o=t.selectId)&&void 0!==o?o:M=>M.id,sortComparer:null!==(n=t.sortComparer)&&void 0!==n&&n},s=function je(){return{getInitialState:function t(o={}){return Object.assign({ids:[],entities:{}},o)}}}(),p=function Ye(){return{getSelectors:function t(o){const n=p=>p.ids,i=p=>p.entities,r=(0,l.P1)(n,i,(p,U)=>p.map(M=>U[M])),s=(0,l.P1)(n,p=>p.length);return o?{selectIds:(0,l.P1)(o,n),selectEntities:(0,l.P1)(o,i),selectAll:(0,l.P1)(o,r),selectTotal:(0,l.P1)(o,s)}:{selectIds:n,selectEntities:i,selectAll:r,selectTotal:s}}}}(),U=r?function Ge(t,o){const{removeOne:n,removeMany:i,removeAll:r}=he(t);function s(c,a){return p([c],a)}function p(c,a){const u=c.filter(g=>!(E(g,t)in a.entities));return 0===u.length?f.None:(d(u,a),f.Both)}function M(c,a){const u=E(c,t);return u in a.entities?(a.ids=a.ids.filter(g=>g!==u),d([c],a),f.Both):s(c,a)}function F(c,a){return S([c],a)}function S(c,a){const u=[],g=c.filter(y=>function T(c,a,u){if(!(a.id in u.entities))return!1;const y=Object.assign({},u.entities[a.id],a.changes),O=E(y,t);return delete u.entities[a.id],c.push(y),O!==a.id}(u,y,a)).length>0;if(0===u.length)return f.None;{const y=a.ids,O=[];return a.ids=a.ids.filter((I,B)=>I in a.entities||(O.push(B),!1)),d(u,a),!g&&O.every(I=>a.ids[I]===y[I])?f.EntitiesOnly:f.Both}}function m(c,a){const u=[],g=[];for(const I of c){const B=E(I,t);B in a.entities?g.push({id:B,changes:I}):u.push(I)}const y=S(g,a),O=p(u,a);switch(!0){case O===f.None&&y===f.None:return f.None;case O===f.Both||y===f.Both:return f.Both;default:return f.EntitiesOnly}}function d(c,a){c.sort(o);const u=[];let g=0,y=0;for(;g<c.length&&y<a.ids.length;){const O=c[g],I=E(O,t),B=a.ids[y];o(O,a.entities[B])<=0?(u.push(I),g++):(u.push(B),y++)}a.ids=u.concat(g<c.length?c.slice(g).map(t):a.ids.slice(y)),c.forEach((O,I)=>{a.entities[t(O)]=O})}return{removeOne:n,removeMany:i,removeAll:r,addOne:_(s),updateOne:_(F),upsertOne:_(function b(c,a){return m([c],a)}),setAll:_(function U(c,a){return a.entities={},a.ids=[],p(c,a),f.Both}),setOne:_(M),setMany:_(function w(c,a){const u=c.map(g=>M(g,a));switch(!0){case u.some(g=>g===f.Both):return f.Both;case u.some(g=>g===f.EntitiesOnly):return f.EntitiesOnly;default:return f.None}}),addMany:_(p),updateMany:_(S),upsertMany:_(m),map:_(function z(c,a){return S(a.ids.reduce((g,y)=>{const O=c(a.entities[y]);return O!==a.entities[y]&&g.push({id:y,changes:O}),g},[]),a)}),mapOne:_(function A({map:c,id:a},u){const g=u.entities[a];return g?F({id:a,changes:c(g)},u):f.None})}}(i,r):he(i);return Object.assign(Object.assign(Object.assign({selectId:i,sortComparer:r},s),p),U)}const P=ye({selectId:function $e(t){return t.id},sortComparer:function Je(t,o){return t.attachDate&&o.attachDate?t.attachDate<o.attachDate?1:-1:1}}),ze=P.getInitialState({apiWorking:!1,filesUploadedAndUrlAddedToDb:[],errMsg:void 0,error:!1}),qe=(0,l.Lq)(ze,(0,l.on)(ce,t=>P.removeAll(Object.assign(Object.assign({},t),{apiWorking:!1,error:!1,errMsg:void 0,filesUploadedAndUrlAddedToDb:[]}))),(0,l.on)(K,(t,{file:o,fileId:n})=>{const i={attachDate:(new Date).getTime(),dateModified:o.lastModified,file:o,fileName:o.name,fileSize:o.size,id:n,completed:!1,progress:0,downloadUrl:void 0};return P.addOne(i,Object.assign(Object.assign({},t),{apiWorking:!0}))}),(0,l.on)(V,(t,{fileId:o,progress:n,downloadUrl:i})=>{var r,s;const p={id:o,changes:{progress:null!=n?n:null===(r=t.entities[o])||void 0===r?void 0:r.progress,downloadUrl:null!=i?i:null===(s=t.entities[o])||void 0===s?void 0:s.downloadUrl}};return P.updateOne(p,Object.assign(Object.assign({},t),{apiWorking:!0}))}),(0,l.on)(X,(t,{fileId:o})=>{const n={id:o,changes:{completed:!0,completedDate:(new Date).getTime()}};return P.updateOne(n,Object.assign(Object.assign({},t),{apiWorking:!1}))}),(0,l.on)(de,(t,{errMsg:o})=>Object.assign(Object.assign({},t),{apiWorking:!1,error:!0,errMsg:o})),(0,l.on)(ee,(t,{photoData:o})=>P.updateOne({id:o.id,changes:{urlUploaded:!1}},Object.assign(Object.assign({},t),{apiWorking:!0}))),(0,l.on)(te,(t,{photoData:o})=>{var n;const i={id:o.id,changes:{urlUploaded:!0}},r=[...null!==(n=t.filesUploadedAndUrlAddedToDb)&&void 0!==n?n:[]];return r.push(o),P.updateOne(i,Object.assign(Object.assign({},t),{apiWorking:!1,filesUploadedAndUrlAddedToDb:r}))}),(0,l.on)(pe,(t,{errMsg:o})=>Object.assign(Object.assign({},t),{apiWorking:!1,error:!0,errMsg:o})));function Ke(t,o){return qe(t,o)}const H=(0,l.ZF)(ge),_e=((0,l.P1)(H,P.getSelectors().selectIds),(0,l.P1)(H,P.getSelectors().selectEntities),(0,l.P1)(H,P.getSelectors().selectAll)),Xe=(0,l.P1)(H,P.getSelectors().selectTotal),Ve=(0,l.P1)(H,t=>t.apiWorking),ne=(0,l.P1)(H,t=>t.filesUploadedAndUrlAddedToDb),et=(0,l.P1)(Xe,ne,(t,o)=>t===o.length),tt=(0,l.P1)(_e,ne,(t,o)=>({total:t,uploadings:o})),D=ye({selectId:function nt(t){return t.id},sortComparer:function ot(t,o){return t.dateUploaded&&o.dateUploaded?t.dateUploaded<o.dateUploaded?1:-1:1}}),it=D.getInitialState({apiWorking:!1,errMsg:void 0,error:!1}),st=(0,l.Lq)(it,(0,l.on)(Y,t=>Object.assign(Object.assign({},t),{apiWorking:!0})),(0,l.on)(ue,(t,{files:o})=>D.setAll(o,Object.assign(Object.assign({},t),{apiWorking:!1}))),(0,l.on)(fe,t=>D.removeAll(Object.assign(Object.assign({},t),{apiWorking:!1}))));function rt(t,o){return st(t,o)}var at=h(5839);const W=(0,l.ZF)(me),lt=((0,l.P1)(W,D.getSelectors().selectIds),(0,l.P1)(W,D.getSelectors().selectEntities),(0,l.P1)(W,D.getSelectors().selectAll)),ct=(0,l.P1)(W,D.getSelectors().selectTotal),dt=(0,l.P1)(W,at.t0,(t,o)=>t.apiWorking||!!o),pt=(0,l.P1)(W,t=>t.apiWorking),ut=(0,l.P1)(lt,t=>{if(t&&t.length>0){const o=[...t];return o.sort((i,r)=>i.dateUploaded>r.dateUploaded?-1:1),o.slice(0,5)}return[]});var ft=h(5439);let oe=(()=>{class t{constructor(n){this.storage=n}uploadBlob(n,i){const r="uploader-app/"+this.getCurrentTime()+"/"+i,s=this.storage.ref(r),p=s.put(n);return{ref:s,task:p}}getCurrentTime(){return ft().format("MM-DD-YYYY")}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(q.Q1))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var C=h(5265),ie=h(2843),L=h(4004),R=h(262);let mt=(()=>{class t{constructor(n,i){this.firestore=n,this.storage=i}createDocument(n,i){const r=(0,C.JU)(this.firestore,"uploader/"+i);return(0,C.pl)(r,n)}updateDocument(n){if(n){const i=(0,C.JU)(this.firestore,"uploader/");return(0,C.r7)(i,{amount:n})}return Promise.resolve()}addDocumentToCollection(n,i){const r=(0,C.JU)((0,C.hJ)(this.firestore,"uploader/"+i)),s=r.id,p=Object.assign(Object.assign({},n),{id:s});return{operationObs:(0,C.pl)(r,p),id:s}}getDocument(n){const i=(0,C.JU)(this.firestore,"uploader/"+n);return(0,C.KO)(i).pipe((0,j.q)(1),(0,L.U)(r=>r.data()),(0,R.K)(r=>(console.error(r),(0,ie._)(()=>{const s=new Error(r);return s.timestamp=Date.now(),s}))))}getDataByCollectionName(n){const i=(0,C.hJ)(this.firestore,"uploader/");return(0,C.$k)(i).pipe((0,j.q)(1),(0,R.K)(r=>(console.error(r),(0,ie._)(()=>{const s=new Error(r);return s.timestamp=Date.now(),s}))),(0,L.U)(r=>r.map(s=>{const p=s.data();return Object.assign({id:s.id},p)})))}getCollection(n){const i=(0,C.hJ)(this.firestore,"uploader/"+n);return(0,C.$k)(i).pipe((0,j.q)(1),(0,R.K)(r=>(console.error(r),(0,ie._)(()=>{const s=new Error(r);return s.timestamp=Date.now(),s}))),(0,L.U)(r=>r.map(s=>{const p=s.data();return Object.assign({},p)})))}uploadBlob(n){return this.storage.ref("folder-1").put(n)}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(C.gg),e.LFG(q.Q1))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Q=(()=>{class t{constructor(n,i,r){this.store=n,this.ss=i,this.rs=r,this.filesUploadingAll$=this.store.select(_e),this.anyFilesUploading$=this.store.select(Ve),this.filesUploaded$=this.store.select(ne),this.isFilesUploadFinished$=this.store.select(et),this.uploadingsAndTotalFiles$=this.store.select(tt),this.userFilesApiLoading$=this.store.select(dt),this.userFileApiWorking$=this.store.select(pt),this.userFilesCount$=this.store.select(ct),this.userRecentUploads$=this.store.select(ut)}attachFile(n,i){this.store.dispatch(le({file:n,fileId:i}))}cleanUpAttachedFiles(){this.store.dispatch(ce())}uploadFile(n,i){return this.ss.uploadBlob(n,i)}addPhotoUrl(n,i){return this.rs.addDocumentToCollection(n,i+"/photos")}getUserPhotos(n){return this.rs.getCollection(n+"/photos")}getUserFiles(){return this.store.dispatch(Y({user:void 0}))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(l.yh),e.LFG(oe),e.LFG(mt))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var G=h(3702),Ue=h(3003),Z=h(9808),x=h(7093),ht=h(7423),$=h(5245),yt=h(5899);let _t=(()=>{class t{constructor(){this.mode="indeterminate"}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["shared-loading-bar"]],inputs:{progress:"progress",mode:"mode"},decls:2,vars:3,consts:[[1,"parent"],[3,"mode","value","color"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"mat-progress-bar",1),e.qZA()),2&n&&(e.xp6(1),e.Q6J("mode",i.mode)("value",i.progress)("color",100===i.progress?"primary":"accent"))},directives:[yt.pW],styles:[".parent[_ngcontent-%COMP%]{height:100%}mat-progress-bar.mat-progress-bar[_ngcontent-%COMP%]{height:100%;border-radius:30px}"]}),t})();var xe=h(4836),se=h(837);function Ut(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",15)(2,"div"),e._uU(3),e.qZA()(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(3),e.hij(" Uploading ( ",n.file.progress,"% ) ")}}function xt(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"shared-loading-bar",16),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("progress",n.file.progress)("mode","determinate")}}function vt(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",17),e._UZ(2,"img",18),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("src",n.imgPreview,e.LSH)}}function Ot(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"a",19),e._uU(2,"Click here"),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("href",n.file.downloadUrl,e.LSH)}}function At(t,o){1&t&&e._uU(0," Creating URL... ")}function Ct(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",3)(2,"div",4)(3,"div",5),e.YNc(4,Ut,4,1,"ng-container",6),e.qZA(),e.TgZ(5,"div",7)(6,"div",8),e.YNc(7,xt,2,2,"ng-container",0),e.qZA()(),e.YNc(8,vt,3,1,"ng-container",6),e.TgZ(9,"div",9),e._UZ(10,"hr"),e.qZA(),e.TgZ(11,"div",10)(12,"div",11)(13,"div",12),e._uU(14," File Name: "),e.qZA(),e.TgZ(15,"div",13),e._uU(16),e.qZA()(),e.TgZ(17,"div",11)(18,"div",12),e._uU(19," File Size: "),e.qZA(),e.TgZ(20,"div",13),e._uU(21),e.ALo(22,"fileSizeDisplay"),e.qZA()(),e.TgZ(23,"div",11)(24,"div",12),e._uU(25," Date modified: "),e.qZA(),e.TgZ(26,"div"),e._uU(27),e.ALo(28,"dateDisplay"),e.qZA()(),e.TgZ(29,"div",11)(30,"div",12),e._uU(31," Download URL: "),e.qZA(),e.TgZ(32,"div"),e.YNc(33,Ot,3,1,"ng-container",6),e.YNc(34,At,1,0,"ng-template",null,14,e.W1O),e.qZA()()()()(),e.BQk()),2&t){const n=e.MAs(35),i=e.oxw(),r=e.MAs(2),s=e.MAs(4);e.xp6(4),e.Q6J("ngIf",i.file.progress<100)("ngIfElse",r),e.xp6(3),e.Q6J("ngIf",i.file.progress),e.xp6(1),e.Q6J("ngIf",i.isImgType)("ngIfElse",s),e.xp6(8),e.hij(" ",i.file.fileName," "),e.xp6(5),e.hij(" ",e.lcZ(22,10,i.file.fileSize)," "),e.xp6(6),e.hij(" ",e.xi3(28,12,i.file.dateModified,"MDY")," "),e.xp6(6),e.Q6J("ngIf",i.file.downloadUrl)("ngIfElse",n)}}function Mt(t,o){1&t&&(e.TgZ(0,"div",15)(1,"div",20)(2,"mat-icon",21),e._uU(3,"check_circle"),e.qZA()(),e.TgZ(4,"div"),e._uU(5," Completed "),e.qZA()())}function Tt(t,o){1&t&&(e.TgZ(0,"div",17)(1,"mat-icon",22),e._uU(2," description "),e.qZA()())}const Pt=["image/jpeg","image/png","image/gif"];let Lt=(()=>{class t{constructor(){this.isImgType=!1,this.reader=new FileReader}ngOnInit(){}ngOnChanges(n){var i,r,s;this.imgId!==n.file.currentValue.id&&(null===(i=this.file)||void 0===i?void 0:i.file)&&(this.isImgType=!!Pt.includes(this.file.file.type),this.reader.onload=p=>this.imgPreview=this.reader.result,this.reader.readAsDataURL(null===(r=this.file)||void 0===r?void 0:r.file)),this.imgId||(this.imgId=null===(s=this.file)||void 0===s?void 0:s.id)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-item"]],inputs:{file:"file"},features:[e.TTD],decls:5,vars:1,consts:[[4,"ngIf"],["finished",""],["notImg",""],[1,"file-parent"],[1,"card"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px",1,"loading-status","poppins"],[4,"ngIf","ngIfElse"],["fxLayout","row","fxLayoutAlign","center center"],[1,"progress-parent"],[1,"w-100"],["fxLayout","column","fxLayoutAlign","start start","fxLayoutGap","5px",1,"w-100","poppins","info-parent"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",1,"info-line"],[1,"label"],[1,"value"],["noUrl",""],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px"],[3,"progress","mode"],[1,"image-parent"],[1,"preview-img",3,"src"],["download","hi",3,"href"],["fxLayout","column","fxLayoutAlign","center center"],[1,"done"],["fxLayout","row","fxLayoutAlign","center center",1,"file-icon"]],template:function(n,i){1&n&&(e.YNc(0,Ct,36,15,"ng-container",0),e.YNc(1,Mt,6,0,"ng-template",null,1,e.W1O),e.YNc(3,Tt,3,0,"ng-template",null,2,e.W1O)),2&n&&e.Q6J("ngIf",i.file)},directives:[Z.O5,x.xw,x.Wh,x.SQ,_t,$.Hw],pipes:[xe.nV,se.o],styles:[".file-parent[_ngcontent-%COMP%]{margin-top:15px}.file-parent[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border-top-right-radius:25px;border-top-left-radius:25px;background-color:#ededf7}.file-parent[_ngcontent-%COMP%]   .loading-status[_ngcontent-%COMP%]{font-size:13px;height:2rem}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]{height:15rem;width:100%;overflow:hidden;text-align:center}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]   .preview-img[_ngcontent-%COMP%]{height:100%}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]:hover{overflow:auto}.file-parent[_ngcontent-%COMP%]   .progress-parent[_ngcontent-%COMP%]{height:10px;width:97%;margin-bottom:8px}.file-parent[_ngcontent-%COMP%]   .info-parent[_ngcontent-%COMP%]{padding:0 10px 10px;height:7rem;overflow:hidden;font-size:11px}.file-parent[_ngcontent-%COMP%]   .info-parent[_ngcontent-%COMP%]:hover{overflow:auto}.file-parent[_ngcontent-%COMP%]   .info-line[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500}.file-parent[_ngcontent-%COMP%]   mat-icon.done[_ngcontent-%COMP%]{font-size:18px;color:#093;text-align:center;height:100%}.file-parent[_ngcontent-%COMP%]   mat-icon.progress[_ngcontent-%COMP%]{font-size:18px;color:#b38600;text-align:center;height:100%}.file-parent[_ngcontent-%COMP%]   mat-icon.file-icon[_ngcontent-%COMP%]{font-size:10rem;height:15rem;width:100%;color:#555}"]}),t})();var Ft=h(655),It=h(8603);class N{transform(o,n){if(o){let i=o.slice(0,n);return n>=o.length?o:i+".."}return o+""}}N.\u0275fac=function(o){return new(o||N)},N.\u0275pipe=e.Yjl({name:"stringSliceCutoff",type:N,pure:!0}),(0,Ft.gn)([(0,It.Z)()],N.prototype,"transform",null);let Zt=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-shared-photo-record-display"]],inputs:{photo:"photo"},decls:13,vars:16,consts:[["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","15px",1,"quicksand","fw-500"],["alt","Photo img","width","50","height","50",3,"src"],[3,"title"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div"),e._UZ(2,"img",1),e.qZA(),e.TgZ(3,"div",2),e._uU(4),e.ALo(5,"stringSliceCutoff"),e.qZA(),e.TgZ(6,"div"),e._uU(7),e.ALo(8,"fileSizeDisplay"),e.qZA(),e.TgZ(9,"div",2),e.ALo(10,"dateDisplay"),e._uU(11),e.ALo(12,"dateFromNow"),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("src",null==i.photo?null:i.photo.photoUrl,e.LSH),e.xp6(1),e.Q6J("title",null==i.photo?null:i.photo.fileName),e.xp6(1),e.hij(" ",e.xi3(5,6,null==i.photo?null:i.photo.fileName,25)," "),e.xp6(3),e.hij(" ",e.lcZ(8,9,null==i.photo?null:i.photo.fileSize)," "),e.xp6(2),e.Q6J("title",e.xi3(10,11,null==i.photo?null:i.photo.dateUploaded,"FULLDATE")),e.xp6(2),e.hij(" ",e.lcZ(12,14,null==i.photo?null:i.photo.dateUploaded)," "))},directives:[x.xw,x.Wh,x.SQ],pipes:[N,xe.nV,se.o,se.G],styles:[""]}),t})();function wt(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div"),e._UZ(2,"app-shared-photo-record-display",11),e.qZA(),e.BQk()),2&t){const n=o.$implicit;e.xp6(2),e.Q6J("photo",n)}}const St=function(){return["../","history"]};function Et(t,o){if(1&t&&(e.ynx(0),e.YNc(1,wt,3,1,"ng-container",6),e.TgZ(2,"div",7)(3,"a",8)(4,"div",9)(5,"div"),e._uU(6," Go to my files "),e.qZA(),e.TgZ(7,"div",10)(8,"mat-icon"),e._uU(9," arrow_right_alt "),e.qZA()()()()(),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.recentUploads),e.xp6(2),e.Q6J("routerLink",e.DdM(2,St))}}function bt(t,o){1&t&&(e.ynx(0),e._uU(1," Loading... "),e.BQk())}function Dt(t,o){if(1&t&&(e.TgZ(0,"div",12),e.YNc(1,bt,2,0,"ng-container",3),e.qZA()),2&t){const n=e.oxw(),i=e.MAs(8);e.xp6(1),e.Q6J("ngIf",n.apiWorking)("ngIfElse",i)}}function Bt(t,o){1&t&&(e.TgZ(0,"div"),e._uU(1," You have not uplaoded anything yet. \xaf\\_(\u30c4)_/\xaf "),e.qZA())}let Ht=(()=>{class t{constructor(){this.recentUploads=[],this.apiWorking=!1}ngOnInit(){}ngOnChanges(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main-welcome-recent-uploads"]],inputs:{recentUploads:"recentUploads",apiWorking:"apiWorking"},features:[e.TTD],decls:9,vars:2,consts:[["fxLayout","column","fxLayoutAlign","start start","fxLayoutGap","20px"],[1,"poppins","title","bb-1"],["fxLayout","column","fxLayoutGap","5px","fxLayoutAlign","start stretch"],[4,"ngIf","ngIfElse"],["noRecentPhotos",""],["loaded",""],[4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center",1,"poppins","mt-2"],[3,"routerLink"],["fxLayout","row","fxLayoutAlign","center center"],["fxLayout","column","fxLayoutAlign","center center"],[3,"photo"],[1,"poppins","gray-text","empty-text"]],template:function(n,i){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2," Recent uploads: "),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,Et,10,3,"ng-container",3),e.qZA()(),e.YNc(5,Dt,2,2,"ng-template",null,4,e.W1O),e.YNc(7,Bt,2,0,"ng-template",null,5,e.W1O)),2&n){const r=e.MAs(6);e.xp6(4),e.Q6J("ngIf",i.recentUploads&&i.recentUploads.length>0)("ngIfElse",r)}},directives:[x.xw,x.Wh,x.SQ,Z.O5,Z.sg,Zt,k.yS,$.Hw],styles:[".title[_ngcontent-%COMP%]{font-size:20px}.empty-text[_ngcontent-%COMP%]{font-size:17px}"],changeDetection:0}),t})();function Wt(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"app-main-welcome-recent-uploads",2),e.ALo(2,"async"),e.ALo(3,"async"),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("recentUploads",e.lcZ(2,2,n.us.userRecentUploads$))("apiWorking",e.lcZ(3,4,n.us.userFileApiWorking$))}}const Nt=function(){return["/","auth","signin"]};function kt(t,o){1&t&&(e.TgZ(0,"div",3)(1,"div",4),e._uU(2," Hello! "),e.qZA(),e.TgZ(3,"div",5)(4,"div"),e._UZ(5,"img",6),e.qZA(),e.TgZ(6,"div",7)(7,"mat-icon",8),e._uU(8,"face"),e.qZA()()(),e.TgZ(9,"div",9)(10,"a",10),e._uU(11,"Create a Uploader account to get started."),e.qZA()()()),2&t&&(e.xp6(10),e.Q6J("routerLink",e.DdM(1,Nt)))}let Rt=(()=>{class t{constructor(n){this.us=n,this.fileList=[]}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(Q))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main-welcome"]],inputs:{currentUser:"currentUser",fileList:"fileList"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noUser",""],[3,"recentUploads","apiWorking"],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","20px",1,"no-user"],[1,"poppins","main"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px"],["src","assets/img/uploader.png","alt","logo",1,"logo-img"],["fxLayout","row","fxLayoutAlign","center center"],[1,"welcome-icon"],[1,"poppins"],[3,"routerLink"]],template:function(n,i){if(1&n&&(e.YNc(0,Wt,4,6,"ng-container",0),e.YNc(1,kt,12,2,"ng-template",null,1,e.W1O)),2&n){const r=e.MAs(2);e.Q6J("ngIf",i.currentUser)("ngIfElse",r)}},directives:[Z.O5,Ht,x.xw,x.Wh,x.SQ,$.Hw,k.yS],pipes:[Z.Ov],styles:["[_nghost-%COMP%]{width:100%}.no-user[_ngcontent-%COMP%]   .logo-img[_ngcontent-%COMP%]{height:4rem}.no-user[_ngcontent-%COMP%]   .welcome-icon[_ngcontent-%COMP%]{font-size:4.7rem;height:4.7rem;width:4.7rem;color:#5f5dbb}.no-user[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{font-size:32px;color:#5f5dbb}.no-user[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#5f5dbb}.user[_ngcontent-%COMP%]{font-size:20px}.user[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{color:#2a2961}"]}),t})();var Qt=h(7579);let ve=(()=>{class t{constructor(){this.wholePage=!1,this.loading=!0,this.logoShakeState=!1,this.compDest$=new Qt.x}ngOnChanges(n){this.parentClass=this.wholePage?"whole-page loading-container":"container loading-container mt-5"}ngOnInit(){}ngOnDestroy(){this.compDest$.next(null),this.compDest$.complete()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-shared-loading"]],inputs:{wholePage:"wholePage",message:"message"},features:[e.TTD],decls:12,vars:3,consts:[["fxLayout","column","fxLayoutAlign","center center",1,"w-100"],[1,""],[1,"loading-logo"],["src","assets/img/uploader.png","alt","logo",1,"logo-img","d-inline-block"],[1,"loading-parent"],[1,"lds-facebook"],[1,"secfont"]],template:function(n,i){1&n&&(e.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"div",2),e._UZ(4,"img",3),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5),e._UZ(7,"div")(8,"div")(9,"div"),e.qZA()(),e.TgZ(10,"div",6),e._uU(11),e.qZA()()()),2&n&&(e.Tol(i.parentClass),e.xp6(11),e.hij(" Loading ",i.message," ... "))},directives:[x.xw,x.Wh],styles:[".loading-logo[_ngcontent-%COMP%]{height:3rem}.loading-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%}.loading-parent[_ngcontent-%COMP%]{justify-content:center;align-items:center}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}.whole-page[_ngcontent-%COMP%]{position:fixed;width:100%}.lds-facebook[_ngcontent-%COMP%]{display:inline-block;position:relative;width:80px;height:80px}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:inline-block;position:absolute;left:8px;width:16px;background:#007bff;animation:lds-facebook 1.2s cubic-bezier(0,.5,.5,1) infinite}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(1){left:8px;animation-delay:-.24s}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){left:32px;animation-delay:-.12s}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){left:56px;animation-delay:0}@keyframes lds-facebook{0%{top:8px;height:64px}50%,to{top:24px;height:32px}}"]}),t})();const jt=["uploadInput"];function Yt(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",17),e._uU(2),e.qZA(),e.TgZ(3,"div",18)(4,"mat-icon",19),e._uU(5,"task_alt"),e.qZA()(),e.BQk()),2&t){const n=e.oxw().ngIf;e.xp6(2),e.AsE(" ",n.uploadings.length," / ",n.total.length," files uploaded ")}}function Gt(t,o){if(1&t&&(e.TgZ(0,"div",17),e._uU(1),e.qZA(),e.TgZ(2,"mat-icon",20),e._uU(3,"hourglass_bottom"),e.qZA()),2&t){const n=e.oxw().ngIf;e.xp6(1),e.AsE(" Uploading: ",n.uploadings.length," / ",n.total.length," ")}}function $t(t,o){if(1&t&&(e.ynx(0),e.YNc(1,Yt,6,2,"ng-container",0),e.ALo(2,"async"),e.YNc(3,Gt,4,2,"ng-template",null,16,e.W1O),e.BQk()),2&t){const n=e.MAs(4),i=e.oxw(4);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,i.fs.isFilesUploadFinished$))("ngIfElse",n)}}function Jt(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",21),e._UZ(2,"app-upload-item",22),e.qZA(),e.BQk()),2&t){const n=o.$implicit;e.xp6(2),e.Q6J("file",n)}}function zt(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",10)(2,"div",12)(3,"div",13),e.YNc(4,$t,5,4,"ng-container",9),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"section",14),e.YNc(7,Jt,3,1,"ng-container",15),e.qZA()(),e.BQk()),2&t){const n=e.oxw().ngIf,i=e.oxw(2);e.xp6(4),e.Q6J("ngIf",e.lcZ(5,3,i.fs.uploadingsAndTotalFiles$)),e.xp6(3),e.Q6J("ngForOf",n)("ngForTrackBy",i.trackById)}}function qt(t,o){if(1&t&&(e.ynx(0),e.YNc(1,zt,8,5,"ng-container",9),e.BQk()),2&t){const n=o.ngIf;e.xp6(1),e.Q6J("ngIf",n.length>0)}}function Kt(t,o){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"input",3,4),e.NdJ("change",function(r){return e.CHM(n),e.oxw().onFileInputClick(r)}),e.qZA()(),e.TgZ(4,"div",5)(5,"div",6),e.NdJ("click",function(){return e.CHM(n),e.oxw().onFileUpload()}),e.TgZ(6,"div",7),e._uU(7," Select items to upload "),e.qZA(),e.TgZ(8,"div")(9,"button",8),e.ALo(10,"async"),e.TgZ(11,"mat-icon"),e._uU(12,"add"),e.qZA()()()(),e.YNc(13,qt,2,1,"ng-container",9),e.ALo(14,"async"),e.TgZ(15,"div",10),e._UZ(16,"app-main-welcome",11),e.ALo(17,"async"),e.qZA()(),e.BQk()}if(2&t){const n=e.oxw();e.xp6(9),e.Q6J("disabled",!e.lcZ(10,3,n.as.currentUser$)),e.xp6(4),e.Q6J("ngIf",e.lcZ(14,5,n.fs.filesUploadingAll$)),e.xp6(3),e.Q6J("currentUser",e.lcZ(17,7,n.as.currentUser$))}}function Xt(t,o){1&t&&(e.TgZ(0,"div",10),e._UZ(1,"app-shared-loading"),e.qZA())}function en(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4)(4,"div"),e._uU(5," My Files "),e.qZA(),e.TgZ(6,"div"),e._uU(7),e.ALo(8,"async"),e.qZA()(),e._UZ(9,"hr",5),e.qZA()(),e.BQk()),2&t){const n=e.oxw();e.xp6(7),e.hij(" (",e.lcZ(8,1,n.fs.userFilesCount$),") ")}}function tn(t,o){1&t&&(e.TgZ(0,"div",5),e._UZ(1,"app-shared-loading"),e.qZA())}const nn=[{path:"",component:Le,children:[{path:"",redirectTo:"upload",pathMatch:"full"},{path:"upload",component:(()=>{class t{constructor(n,i,r,s){this.fs=n,this.rs=i,this.as=r,this.ts=s}ngOnInit(){}onFileUpload(){var n;const i=null===(n=this.uploadInput)||void 0===n?void 0:n.nativeElement;i&&this.as.currentUser$.pipe((0,j.q)(1)).subscribe(r=>{r?i.click():this.ts.openSingletonToast("warning","You are not logged in.")})}onFileInputClick(n){var i;const r=null===(i=n.target)||void 0===i?void 0:i.files;r&&(this.fs.cleanUpAttachedFiles(),Object.keys(r).forEach(p=>{this.fs.attachFile(r[p],(new Date).getTime()+p+"")}))}trackById(n,i){return i.id}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(Q),e.Y36(oe),e.Y36(G.e),e.Y36(Ue.q))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main-all"]],viewQuery:function(n,i){if(1&n&&e.Gf(jt,5),2&n){let r;e.iGM(r=e.CRH())&&(i.uploadInput=r.first)}},decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,""],["type","file","multiple","",1,"upload-input",3,"change"],["uploadInput",""],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","30px",1,"w-100"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","15px",1,"quicksand","upload-action",3,"click"],[1,"text"],["mat-fab","","color","primary","aria-label","Upload files",3,"disabled"],[4,"ngIf"],[1,"w-100"],[3,"currentUser"],[1,"uploading-title","quicksand","fw-500"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","5px",1,""],["fxLayout","row wrap","fxLayoutAlign","start center","fxLayoutGap","15px",1,"w-100"],[4,"ngFor","ngForOf","ngForTrackBy"],["uploading",""],[1,"bb-1"],["fxLayout","column","fxLayoutAlign","center center",1,""],[1,"text-success"],[1,"text-primary"],["fxFlex.gt-sm","23","fxFlex","100"],[3,"file"]],template:function(n,i){if(1&n&&(e.YNc(0,Kt,18,9,"ng-container",0),e.ALo(1,"async"),e.YNc(2,Xt,2,0,"ng-template",null,1,e.W1O)),2&n){const r=e.MAs(3);e.Q6J("ngIf",!1===e.lcZ(1,2,i.as.apiLoading$))("ngIfElse",r)}},directives:[Z.O5,x.xw,x.Wh,x.SQ,ht.lW,$.Hw,Z.sg,x.yH,Lt,Rt,ve],pipes:[Z.Ov],styles:[".upload-action[_ngcontent-%COMP%]{border:1px solid #ccc;padding:5px 25px;border-radius:30px;background-color:#e6f2ff;cursor:pointer}.upload-action[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:20px;color:#5f5dbb}.upload-input[_ngcontent-%COMP%]{display:none;height:0px}.uploading-title[_ngcontent-%COMP%]{font-size:20px}"]}),t})(),data:{pageTitle:"Upload Files"}},{path:"history",component:(()=>{class t{constructor(n,i,r,s){this.fs=n,this.rs=i,this.as=r,this.ts=s}ngOnInit(){this.fs.getUserFiles()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(Q),e.Y36(oe),e.Y36(G.e),e.Y36(Ue.q))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main-history"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","45px",1,"w-100"],[1,"title","quicksand","fw-500","w-100"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","5px"],[1,"w-100"]],template:function(n,i){if(1&n&&(e.YNc(0,en,10,3,"ng-container",0),e.ALo(1,"async"),e.YNc(2,tn,2,0,"ng-template",null,1,e.W1O)),2&n){const r=e.MAs(3);e.Q6J("ngIf",!1===e.lcZ(1,2,i.fs.userFilesApiLoading$))("ngIfElse",r)}},directives:[Z.O5,x.xw,x.Wh,x.SQ,ve],pipes:[Z.Ov],styles:[".title[_ngcontent-%COMP%]{font-size:20px}"]}),t})(),data:{pageTitle:"My Files"}}]}];let on=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[k.Bz.forChild(nn)],k.Bz]}),t})();var Oe=h(3900),sn=h(9770),J=h(9646),an=h(1884),ln=h(6556);let cn=(()=>{class t{constructor(n,i,r){this.actions$=n,this.us=i,this.as=r,this.getUserFiles$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(Y,te),(0,v.IC)(()=>this.as.currentUser$),(0,L.U)(s=>s[1]),(0,Oe.w)(s=>function rn(t,o,n){return(0,sn.P)(()=>t()?o:n)}(()=>!!s,this.us.getUserPhotos(null==s?void 0:s.email).pipe((0,L.U)(p=>ue({files:p})),(0,R.K)(p=>(0,J.of)(Re({errMsg:(0,ln.S)(p)})))),(0,J.of)(fe()))))),this.userChange$=(0,v.GW)(()=>this.as.currentUser$.pipe((0,an.x)((s,p)=>(null==s?void 0:s.email)===(null==p?void 0:p.email)),(0,Oe.w)(s=>(0,J.of)(Y({user:s})))))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(v.eX),e.LFG(Q),e.LFG(G.e))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();var Ae=h(5577),re=h(8746),Ce=h(9300),dn=h(7272);const pn=[(()=>{class t{constructor(n,i,r){this.actions$=n,this.us=i,this.as=r,this.attachFileForUpload$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(le),(0,L.U)(s=>K({fileId:s.fileId,file:s.file})))),this.uploadFileStart$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(K),(0,Ae.z)(s=>{var p;const U=s.fileId,M=s.file,w=null!==(p=M.name)&&void 0!==p?p:"File-name-"+(new Date).getTime(),F=(new Date).getTime(),T=this.us.uploadFile(M,w);let S=[T.task.percentageChanges().pipe((0,L.U)(A=>({fileId:U,percent:A})),(0,re.x)(()=>{console.log("Upload done")})),T.ref.getDownloadURL().pipe((0,L.U)(A=>({fileId:U,url:A})),(0,re.x)(()=>{console.log("Fetch URL done")}))];return(0,dn.z)(...S).pipe((0,L.U)(A=>{var b;const m=null!==(b=A.percent)&&void 0!==b?b:A.url?100:A.percent;return V({fileId:U,fileName:w,fileSize:s.file.size,uploadDate:F,downloadUrl:A.url,progress:m})}),(0,R.K)(A=>(console.error("Upload Error!"+A),(0,J.of)(de({errMsg:A})))),(0,re.x)(()=>{console.log("Upload and URL done")}))}))),this.uploadFileFinished$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(V),(0,Ce.h)(s=>!(!s.downloadUrl||100!==s.progress)),(0,L.U)(s=>X({fileId:s.fileId,fileName:s.fileName,fileSize:s.fileSize,uploadDate:s.uploadDate,downloadUrl:s.downloadUrl})))),this.updateUserPhotoDatabaseAfterUploadSuccess$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(X),(0,L.U)(s=>ee({photoData:{id:s.fileId,dateUploaded:s.uploadDate,fileId:s.fileId,fileName:s.fileName,fileSize:s.fileSize,photoUrl:s.downloadUrl}})))),this.updateUserPhotoDatabase$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(ee),(0,v.IC)(()=>this.as.currentUser$),(0,Ce.h)(s=>{var p;return!!(null===(p=s[1])||void 0===p?void 0:p.email)}),(0,Ae.z)(s=>{var p;const U=null===(p=s[1])||void 0===p?void 0:p.email,w=this.us.addPhotoUrl(s[0].photoData,U).operationObs,F=s[0].photoData.id;return w.then(T=>{const S=Object.assign(Object.assign({},s[0].photoData),{id:F});return te({photoData:S})}).catch(T=>pe({errMsg:T}))})))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(v.eX),e.LFG(Q),e.LFG(G.e))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})()];let un=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[],imports:[[Pe.n,Me.I,Te.d,l.Aw.forFeature(ge,Ke),l.Aw.forFeature(me,rt),v.sQ.forFeature(pn),v.sQ.forFeature([cn]),q.TE,on]]}),t})()}}]);