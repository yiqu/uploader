"use strict";(self.webpackChunkuploader=self.webpackChunkuploader||[]).push([[482],{7482:(ke,H,h)=>{h.r(H),h.d(H,{MainModule:()=>Re});var Y=h(4585),I=h(6642),g=h(5620),_=h(9808),W=h(2155),X=h(8282),e=h(5e3);let V=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[],imports:[[_.ez,W.o9,X.p]]}),t})();var q=h(7462),ee=h(2861),S=h(5215);let te=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main"]],decls:2,vars:0,consts:[[1,"container","mb-5","mt-3"]],template:function(n,r){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"router-outlet"),e.qZA())},directives:[S.lC],styles:[""]}),t})();const z=(0,g.PH)("[Upload/UI] attach a file",(0,g.Ky)()),w=(0,g.PH)("[Upload/API] Upload file start",(0,g.Ky)()),G=(0,g.PH)("[Upload/API] Upload file successful",(0,g.Ky)()),se=(0,g.PH)("[Upload/API] Upload file failed",(0,g.Ky)()),N=(0,g.PH)("[Upload/API] Upload file progress update",(0,g.Ky)()),J="uploadFiles";var c=(()=>{return(t=c||(c={}))[t.EntitiesOnly=0]="EntitiesOnly",t[t.Both=1]="Both",t[t.None=2]="None",c;var t})();function v(t){return function(n,r){const d={ids:[...r.ids],entities:Object.assign({},r.entities)},m=t(n,d);return m===c.Both?Object.assign({},r,d):m===c.EntitiesOnly?Object.assign(Object.assign({},r),{entities:d.entities}):r}}function A(t,o){const n=o(t);return(0,e.X6Q)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",o.toString()),n}function R(t){function o(p,s){const a=A(p,t);return a in s.entities?c.None:(s.ids.push(a),s.entities[a]=p,c.Both)}function n(p,s){let a=!1;for(const i of p)a=o(i,s)!==c.None||a;return a?c.Both:c.None}function d(p,s){const a=A(p,t);return a in s.entities?(s.entities[a]=p,c.EntitiesOnly):(s.ids.push(a),s.entities[a]=p,c.Both)}function O(p,s){const i=(p instanceof Array?p:s.ids.filter(l=>p(s.entities[l]))).filter(l=>l in s.entities).map(l=>delete s.entities[l]).length>0;return i&&(s.ids=s.ids.filter(l=>l in s.entities)),i?c.Both:c.None}function b(p,s){return L([p],s)}function L(p,s){const a={};return(p=p.filter(l=>l.id in s.entities)).length>0?p.filter(u=>function F(p,s,a){const l=Object.assign({},a.entities[s.id],s.changes),u=A(l,t),f=u!==s.id;return f&&(p[s.id]=u,delete a.entities[s.id]),a.entities[u]=l,f}(a,u,s)).length>0?(s.ids=s.ids.map(u=>a[u]||u),c.Both):c.EntitiesOnly:c.None}function B(p,s){const a=[],i=[];for(const f of p){const M=A(f,t);M in s.entities?i.push({id:M,changes:f}):a.push(f)}const l=L(i,s),u=n(a,s);switch(!0){case u===c.None&&l===c.None:return c.None;case u===c.Both||l===c.Both:return c.Both;default:return c.EntitiesOnly}}return{removeAll:function C(p){return Object.assign({},p,{ids:[],entities:{}})},addOne:v(o),addMany:v(n),setAll:v(function r(p,s){return s.ids=[],s.entities={},n(p,s),c.Both}),setOne:v(d),setMany:v(function m(p,s){const a=p.map(i=>d(i,s));switch(!0){case a.some(i=>i===c.Both):return c.Both;case a.some(i=>i===c.EntitiesOnly):return c.EntitiesOnly;default:return c.None}}),updateOne:v(b),updateMany:v(L),upsertOne:v(function D(p,s){return B([p],s)}),upsertMany:v(B),removeOne:v(function y(p,s){return O([p],s)}),removeMany:v(O),map:v(function E(p,s){return L(s.ids.reduce((l,u)=>{const f=p(s.entities[u]);return f!==s.entities[u]&&l.push({id:u,changes:f}),l},[]).filter(({id:l})=>l in s.entities),s)}),mapOne:v(function Q({map:p,id:s},a){const i=a.entities[s];return i?b({id:s,changes:p(i)},a):c.None})}}const U=function pe(t={}){var o,n;const{selectId:r,sortComparer:d}={selectId:null!==(o=t.selectId)&&void 0!==o?o:C=>C.id,sortComparer:null!==(n=t.sortComparer)&&void 0!==n&&n},m=function ce(){return{getInitialState:function t(o={}){return Object.assign({ids:[],entities:{}},o)}}}(),y=function ue(){return{getSelectors:function t(o){const n=y=>y.ids,r=y=>y.entities,d=(0,g.P1)(n,r,(y,O)=>y.map(C=>O[C])),m=(0,g.P1)(n,y=>y.length);return o?{selectIds:(0,g.P1)(o,n),selectEntities:(0,g.P1)(o,r),selectAll:(0,g.P1)(o,d),selectTotal:(0,g.P1)(o,m)}:{selectIds:n,selectEntities:r,selectAll:d,selectTotal:m}}}}(),O=d?function de(t,o){const{removeOne:n,removeMany:r,removeAll:d}=R(t);function m(a,i){return y([a],i)}function y(a,i){const l=a.filter(u=>!(A(u,t)in i.entities));return 0===l.length?c.None:(s(l,i),c.Both)}function C(a,i){const l=A(a,t);return l in i.entities?(i.ids=i.ids.filter(u=>u!==l),s([a],i),c.Both):m(a,i)}function b(a,i){return E([a],i)}function E(a,i){const l=[],u=a.filter(f=>function L(a,i,l){if(!(i.id in l.entities))return!1;const f=Object.assign({},l.entities[i.id],i.changes),M=A(f,t);return delete l.entities[i.id],a.push(f),M!==i.id}(l,f,i)).length>0;if(0===l.length)return c.None;{const f=i.ids,M=[];return i.ids=i.ids.filter((x,P)=>x in i.entities||(M.push(P),!1)),s(l,i),!u&&M.every(x=>i.ids[x]===f[x])?c.EntitiesOnly:c.Both}}function p(a,i){const l=[],u=[];for(const x of a){const P=A(x,t);P in i.entities?u.push({id:P,changes:x}):l.push(x)}const f=E(u,i),M=y(l,i);switch(!0){case M===c.None&&f===c.None:return c.None;case M===c.Both||f===c.Both:return c.Both;default:return c.EntitiesOnly}}function s(a,i){a.sort(o);const l=[];let u=0,f=0;for(;u<a.length&&f<i.ids.length;){const M=a[u],x=A(M,t),P=i.ids[f];o(M,i.entities[P])<=0?(l.push(x),u++):(l.push(P),f++)}i.ids=l.concat(u<a.length?a.slice(u).map(t):i.ids.slice(f)),a.forEach((M,x)=>{i.entities[t(M)]=M})}return{removeOne:n,removeMany:r,removeAll:d,addOne:v(m),updateOne:v(b),upsertOne:v(function B(a,i){return p([a],i)}),setAll:v(function O(a,i){return i.entities={},i.ids=[],y(a,i),c.Both}),setOne:v(C),setMany:v(function F(a,i){const l=a.map(u=>C(u,i));switch(!0){case l.some(u=>u===c.Both):return c.Both;case l.some(u=>u===c.EntitiesOnly):return c.EntitiesOnly;default:return c.None}}),addMany:v(y),updateMany:v(E),upsertMany:v(p),map:v(function Q(a,i){return E(i.ids.reduce((u,f)=>{const M=a(i.entities[f]);return M!==i.entities[f]&&u.push({id:f,changes:M}),u},[]),i)}),mapOne:v(function D({map:a,id:i},l){const u=l.entities[i];return u?b({id:i,changes:a(u)},l):c.None})}}(r,d):R(r);return Object.assign(Object.assign(Object.assign({selectId:r,sortComparer:d},m),y),O)}({selectId:function fe(t){return t.id},sortComparer:function ge(t,o){return t.attachDate&&o.attachDate?t.attachDate<o.attachDate?1:-1:1}}),me=U.getInitialState({uploading:!1}),he=(0,g.Lq)(me,(0,g.on)(w,(t,{file:o,fileId:n})=>{const r={attachDate:(new Date).getTime(),dateModified:o.lastModified,file:o,fileName:o.name,fileSize:o.size,id:n,completed:!1,progress:0};return U.addOne(r,Object.assign(Object.assign({},t),{uploading:!0}))}),(0,g.on)(N,(t,{fileId:o,progress:n})=>U.updateOne({id:o,changes:{progress:n}},Object.assign(Object.assign({},t),{uploading:!0}))),(0,g.on)(G,(t,{fileId:o})=>{const n={id:o,changes:{completed:!0,completedDate:(new Date).getTime()}};return U.updateOne(n,Object.assign(Object.assign({},t),{uploading:!1}))}));function ye(t,o){return he(t,o)}const Z=(0,g.ZF)(J),ve=((0,g.P1)(Z,U.getSelectors().selectIds),(0,g.P1)(Z,U.getSelectors().selectEntities),(0,g.P1)(Z,U.getSelectors().selectAll)),Me=((0,g.P1)(Z,U.getSelectors().selectTotal),(0,g.P1)(Z,t=>t.uploading));var Oe=h(5439);let K=(()=>{class t{constructor(n){this.storage=n}uploadBlob(n,r){const d="uploader-app/"+this.getCurrentTime()+"/"+r;return this.storage.ref(d).put(n)}getCurrentTime(){return Oe().format("MM-DD-YYYY")}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(Y.Q1))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),k=(()=>{class t{constructor(n,r){this.store=n,this.ss=r,this.filesUploadingAll$=this.store.select(ve),this.anyFilesUploading$=this.store.select(Me)}attachFile(n,r){this.store.dispatch(z({file:n,fileId:r}))}uploadFile(n,r){return this.ss.uploadBlob(n,r).percentageChanges()}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(g.yh),e.LFG(K))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var T=h(7093),Ce=h(7423),$=h(5245),Ae=h(5899);let Ie=(()=>{class t{constructor(){this.mode="indeterminate"}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["shared-loading-bar"]],inputs:{progress:"progress",mode:"mode"},decls:2,vars:3,consts:[[1,"parent"],[3,"mode","value","color"]],template:function(n,r){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"mat-progress-bar",1),e.qZA()),2&n&&(e.xp6(1),e.Q6J("mode",r.mode)("value",r.progress)("color",100===r.progress?"primary":"accent"))},directives:[Ae.pW],styles:[".parent[_ngcontent-%COMP%]{height:100%}mat-progress-bar.mat-progress-bar[_ngcontent-%COMP%]{height:100%;border-radius:30px}"]}),t})();var Ue=h(4836),Fe=h(837);function Te(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",14)(2,"div"),e._uU(3),e.qZA()(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(3),e.hij(" Uploading ( ",n.file.progress,"% ) ")}}function Pe(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"shared-loading-bar",15),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("progress",n.file.progress)("mode","determinate")}}function Le(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",16),e._UZ(2,"img",17),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("src",n.imgPreview,e.LSH)}}function Ee(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",3)(2,"div",4)(3,"div",5),e.YNc(4,Te,4,1,"ng-container",6),e.qZA(),e.TgZ(5,"div",7)(6,"div",8),e.YNc(7,Pe,2,2,"ng-container",0),e.qZA()(),e.YNc(8,Le,3,1,"ng-container",6),e.TgZ(9,"div",9),e._UZ(10,"hr"),e.qZA(),e.TgZ(11,"div",10)(12,"div",11)(13,"div",12),e._uU(14," File Name: "),e.qZA(),e.TgZ(15,"div",13),e._uU(16),e.qZA()(),e.TgZ(17,"div",11)(18,"div",12),e._uU(19," File Size: "),e.qZA(),e.TgZ(20,"div",13),e._uU(21),e.ALo(22,"fileSizeDisplay"),e.qZA()(),e.TgZ(23,"div",11)(24,"div",12),e._uU(25," Date modified: "),e.qZA(),e.TgZ(26,"div"),e._uU(27),e.ALo(28,"dateDisplay"),e.qZA()()()()(),e.BQk()),2&t){const n=e.oxw(),r=e.MAs(2),d=e.MAs(4);e.xp6(4),e.Q6J("ngIf",n.file.progress<100)("ngIfElse",r),e.xp6(3),e.Q6J("ngIf",n.file.progress),e.xp6(1),e.Q6J("ngIf",n.isImgType)("ngIfElse",d),e.xp6(8),e.hij(" ",n.file.fileName," "),e.xp6(5),e.hij(" ",e.lcZ(22,8,n.file.fileSize)," "),e.xp6(6),e.hij(" ",e.xi3(28,10,n.file.dateModified,"MDY")," ")}}function _e(t,o){1&t&&(e.TgZ(0,"div",14)(1,"div",18)(2,"mat-icon",19),e._uU(3,"check_circle"),e.qZA()(),e.TgZ(4,"div"),e._uU(5," Completed "),e.qZA()())}function Ze(t,o){1&t&&(e.TgZ(0,"div",16)(1,"mat-icon",20),e._uU(2," description "),e.qZA()())}const be=["image/jpeg","image/png","image/gif"];let Be=(()=>{class t{constructor(){this.isImgType=!1,this.reader=new FileReader}ngOnInit(){}ngOnChanges(n){var r,d,m;this.imgId!==n.file.currentValue.id&&(null===(r=this.file)||void 0===r?void 0:r.file)&&(this.isImgType=!!be.includes(this.file.file.type),this.reader.onload=y=>this.imgPreview=this.reader.result,this.reader.readAsDataURL(null===(d=this.file)||void 0===d?void 0:d.file)),this.imgId||(this.imgId=null===(m=this.file)||void 0===m?void 0:m.id)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-item"]],inputs:{file:"file"},features:[e.TTD],decls:5,vars:1,consts:[[4,"ngIf"],["finished",""],["notImg",""],[1,"file-parent"],[1,"card"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px",1,"loading-status","poppins"],[4,"ngIf","ngIfElse"],["fxLayout","row","fxLayoutAlign","center center"],[1,"progress-parent"],[1,"w-100"],["fxLayout","column","fxLayoutAlign","start start","fxLayoutGap","10px",1,"w-100","poppins","info-parent"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",1,"info-line"],[1,"label"],[1,"value"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px"],[3,"progress","mode"],[1,"image-parent"],[1,"preview-img",3,"src"],["fxLayout","column","fxLayoutAlign","center center"],[1,"done"],["fxLayout","row","fxLayoutAlign","center center",1,"file-icon"]],template:function(n,r){1&n&&(e.YNc(0,Ee,29,13,"ng-container",0),e.YNc(1,_e,6,0,"ng-template",null,1,e.W1O),e.YNc(3,Ze,3,0,"ng-template",null,2,e.W1O)),2&n&&e.Q6J("ngIf",r.file)},directives:[_.O5,T.xw,T.Wh,T.SQ,Ie,$.Hw],pipes:[Ue.nV,Fe.o],styles:[".file-parent[_ngcontent-%COMP%]{margin-top:30px}.file-parent[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border-top-right-radius:25px;border-top-left-radius:25px;background-color:#ededf7}.file-parent[_ngcontent-%COMP%]   .loading-status[_ngcontent-%COMP%]{font-size:13px;height:2rem}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]{height:15rem;width:100%;overflow:hidden;text-align:center}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]   .preview-img[_ngcontent-%COMP%]{height:100%}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]:hover{overflow:auto}.file-parent[_ngcontent-%COMP%]   .progress-parent[_ngcontent-%COMP%]{height:10px;width:97%;margin-bottom:8px}.file-parent[_ngcontent-%COMP%]   .info-parent[_ngcontent-%COMP%]{padding:0 10px 10px;height:7rem;overflow:hidden;font-size:13px}.file-parent[_ngcontent-%COMP%]   .info-parent[_ngcontent-%COMP%]:hover{overflow:auto}.file-parent[_ngcontent-%COMP%]   .info-line[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500}.file-parent[_ngcontent-%COMP%]   mat-icon.done[_ngcontent-%COMP%]{font-size:18px;color:#093;text-align:center;height:100%}.file-parent[_ngcontent-%COMP%]   mat-icon.progress[_ngcontent-%COMP%]{font-size:18px;color:#b38600;text-align:center;height:100%}.file-parent[_ngcontent-%COMP%]   mat-icon.file-icon[_ngcontent-%COMP%]{font-size:10rem;height:15rem;width:100%;color:#555}"]}),t})();const Se=["uploadInput"];function we(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",10),e._UZ(2,"app-upload-item",11),e.qZA(),e.BQk()),2&t){const n=o.$implicit;e.xp6(2),e.Q6J("file",n)}}function Ne(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"section",8),e.YNc(2,we,3,1,"ng-container",9),e.qZA(),e.BQk()),2&t){const n=o.ngIf,r=e.oxw();e.xp6(2),e.Q6J("ngForOf",n)("ngForTrackBy",r.trackById)}}const je=[{path:"",component:te,children:[{path:"",redirectTo:"upload",pathMatch:"full"},{path:"upload",component:(()=>{class t{constructor(n,r){this.fs=n,this.rs=r}ngOnInit(){}onFileUpload(){var n;const r=null===(n=this.uploadInput)||void 0===n?void 0:n.nativeElement;r&&r.click()}onFileInputClick(n){var r;const d=null===(r=n.target)||void 0===r?void 0:r.files;d&&Object.keys(d).forEach(y=>{this.fs.attachFile(d[y],(new Date).getTime()+y+"")})}trackById(n,r){return r.id}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(k),e.Y36(K))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main-all"]],viewQuery:function(n,r){if(1&n&&e.Gf(Se,5),2&n){let d;e.iGM(d=e.CRH())&&(r.uploadInput=d.first)}},decls:13,vars:3,consts:[[1,""],["type","file","multiple","",1,"upload-input",3,"change"],["uploadInput",""],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","15px",1,""],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","15px",1,"quicksand","upload-action",3,"click"],[1,"text"],["mat-fab","","color","primary","aria-label","Upload files"],[4,"ngIf"],["fxLayout","row wrap","fxLayoutAlign","start center","fxLayoutGap","15px",1,"w-100"],[4,"ngFor","ngForOf","ngForTrackBy"],["fxFlex.gt-sm","23","fxFlex","100"],[3,"file"]],template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"input",1,2),e.NdJ("change",function(m){return r.onFileInputClick(m)}),e.qZA()(),e.TgZ(3,"div",3)(4,"div",4),e.NdJ("click",function(){return r.onFileUpload()}),e.TgZ(5,"div",5),e._uU(6," Select items to upload "),e.qZA(),e.TgZ(7,"div")(8,"button",6)(9,"mat-icon"),e._uU(10,"file_upload"),e.qZA()()()(),e.YNc(11,Ne,3,2,"ng-container",7),e.ALo(12,"async"),e.qZA()),2&n&&(e.xp6(11),e.Q6J("ngIf",e.lcZ(12,1,r.fs.filesUploadingAll$)))},directives:[T.xw,T.Wh,T.SQ,Ce.lW,$.Hw,_.O5,_.sg,T.yH,Be],pipes:[_.Ov],styles:[".upload-action[_ngcontent-%COMP%]{border:1px solid #ccc;padding:5px 25px;border-radius:30px;background-color:#e6f2ff;cursor:pointer}.upload-action[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:20px}.upload-input[_ngcontent-%COMP%]{display:none;height:0px}"]}),t})(),data:{pageTitle:"Upload Files"}}]}];let Qe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[S.Bz.forChild(je)],S.Bz]}),t})();var j=h(4004),De=h(5577),He=h(262),Ye=h(8746),ze=h(9300),Ge=h(9646);const Je=[(()=>{class t{constructor(n,r){this.actions$=n,this.us=r,this.attachFileForUpload$=(0,I.GW)(()=>this.actions$.pipe((0,I.l4)(z),(0,j.U)(d=>w({fileId:d.fileId,file:d.file}))),{dispatch:!0}),this.uploadFileStart$=(0,I.GW)(()=>this.actions$.pipe((0,I.l4)(w),(0,De.z)(d=>{var m;const y=d.fileId,O=d.file,C=null!==(m=O.name)&&void 0!==m?m:"File-name-"+(new Date).getTime();return this.us.uploadFile(O,C).pipe((0,j.U)(F=>N({fileId:y,progress:F})),(0,He.K)(F=>(console.error("Upload Error!"+F),(0,Ge.of)(se({errMsg:F})))),(0,Ye.x)(()=>{console.log("done")}))}))),this.uploadFileFinished$=(0,I.GW)(()=>this.actions$.pipe((0,I.l4)(N),(0,ze.h)(d=>100===d.progress),(0,j.U)(d=>G({fileId:d.fileId}))))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(I.eX),e.LFG(k))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})()];let Re=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[],imports:[[ee.n,V,q.d,g.Aw.forFeature(J,ye),I.sQ.forFeature(Je),Y.TE,Qe]]}),t})()}}]);