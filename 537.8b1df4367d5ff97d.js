"use strict";(self.webpackChunkuploader=self.webpackChunkuploader||[]).push([[537],{2537:(je,D,M)=>{M.r(D),M.d(D,{MainModule:()=>we});var A=M(6642),g=M(5620),Z=M(9808),Y=M(2155),K=M(8282),e=M(5e3);let $=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[],imports:[[Z.ez,Y.o9,K.p]]}),t})();var W=M(1929),X=M(2861),B=M(5215);let q=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main"]],decls:2,vars:0,consts:[[1,"container","mb-5","mt-3"]],template:function(n,r){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"router-outlet"),e.qZA())},directives:[B.lC],styles:[""]}),t})();const z=(0,g.PH)("[Upload/UI] attach a file",(0,g.Ky)()),S=(0,g.PH)("[Upload/API] Upload file start",(0,g.Ky)()),G=(0,g.PH)("[Upload/API] Upload file successful",(0,g.Ky)()),w=((0,g.PH)("[Upload/API] Upload file failed",(0,g.Ky)()),(0,g.PH)("[Upload/API] Upload file progress update",(0,g.Ky)())),J="uploadFiles";var c=(()=>{return(t=c||(c={}))[t.EntitiesOnly=0]="EntitiesOnly",t[t.Both=1]="Both",t[t.None=2]="None",c;var t})();function m(t){return function(n,r){const p={ids:[...r.ids],entities:Object.assign({},r.entities)},h=t(n,p);return h===c.Both?Object.assign({},r,p):h===c.EntitiesOnly?Object.assign(Object.assign({},r),{entities:p.entities}):r}}function C(t,o){const n=o(t);return(0,e.X6Q)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",o.toString()),n}function k(t){function o(u,s){const a=C(u,t);return a in s.entities?c.None:(s.ids.push(a),s.entities[a]=u,c.Both)}function n(u,s){let a=!1;for(const i of u)a=o(i,s)!==c.None||a;return a?c.Both:c.None}function p(u,s){const a=C(u,t);return a in s.entities?(s.entities[a]=u,c.EntitiesOnly):(s.ids.push(a),s.entities[a]=u,c.Both)}function x(u,s){const i=(u instanceof Array?u:s.ids.filter(l=>u(s.entities[l]))).filter(l=>l in s.entities).map(l=>delete s.entities[l]).length>0;return i&&(s.ids=s.ids.filter(l=>l in s.entities)),i?c.Both:c.None}function _(u,s){return T([u],s)}function T(u,s){const a={};return(u=u.filter(l=>l.id in s.entities)).length>0?u.filter(d=>function j(u,s,a){const l=Object.assign({},a.entities[s.id],s.changes),d=C(l,t),f=d!==s.id;return f&&(u[s.id]=d,delete a.entities[s.id]),a.entities[d]=l,f}(a,d,s)).length>0?(s.ids=s.ids.map(d=>a[d]||d),c.Both):c.EntitiesOnly:c.None}function b(u,s){const a=[],i=[];for(const f of u){const v=C(f,t);v in s.entities?i.push({id:v,changes:f}):a.push(f)}const l=T(i,s),d=n(a,s);switch(!0){case d===c.None&&l===c.None:return c.None;case d===c.Both||l===c.Both:return c.Both;default:return c.EntitiesOnly}}return{removeAll:function I(u){return Object.assign({},u,{ids:[],entities:{}})},addOne:m(o),addMany:m(n),setAll:m(function r(u,s){return s.ids=[],s.entities={},n(u,s),c.Both}),setOne:m(p),setMany:m(function h(u,s){const a=u.map(i=>p(i,s));switch(!0){case a.some(i=>i===c.Both):return c.Both;case a.some(i=>i===c.EntitiesOnly):return c.EntitiesOnly;default:return c.None}}),updateOne:m(_),updateMany:m(T),upsertOne:m(function Q(u,s){return b([u],s)}),upsertMany:m(b),removeOne:m(function y(u,s){return x([u],s)}),removeMany:m(x),map:m(function L(u,s){return T(s.ids.reduce((l,d)=>{const f=u(s.entities[d]);return f!==s.entities[d]&&l.push({id:d,changes:f}),l},[]).filter(({id:l})=>l in s.entities),s)}),mapOne:m(function H({map:u,id:s},a){const i=a.entities[s];return i?_({id:s,changes:u(i)},a):c.None})}}const U=function le(t={}){var o,n;const{selectId:r,sortComparer:p}={selectId:null!==(o=t.selectId)&&void 0!==o?o:I=>I.id,sortComparer:null!==(n=t.sortComparer)&&void 0!==n&&n},h=function re(){return{getInitialState:function t(o={}){return Object.assign({ids:[],entities:{}},o)}}}(),y=function ae(){return{getSelectors:function t(o){const n=y=>y.ids,r=y=>y.entities,p=(0,g.P1)(n,r,(y,x)=>y.map(I=>x[I])),h=(0,g.P1)(n,y=>y.length);return o?{selectIds:(0,g.P1)(o,n),selectEntities:(0,g.P1)(o,r),selectAll:(0,g.P1)(o,p),selectTotal:(0,g.P1)(o,h)}:{selectIds:n,selectEntities:r,selectAll:p,selectTotal:h}}}}(),x=p?function se(t,o){const{removeOne:n,removeMany:r,removeAll:p}=k(t);function h(a,i){return y([a],i)}function y(a,i){const l=a.filter(d=>!(C(d,t)in i.entities));return 0===l.length?c.None:(s(l,i),c.Both)}function I(a,i){const l=C(a,t);return l in i.entities?(i.ids=i.ids.filter(d=>d!==l),s([a],i),c.Both):h(a,i)}function _(a,i){return L([a],i)}function L(a,i){const l=[],d=a.filter(f=>function T(a,i,l){if(!(i.id in l.entities))return!1;const f=Object.assign({},l.entities[i.id],i.changes),v=C(f,t);return delete l.entities[i.id],a.push(f),v!==i.id}(l,f,i)).length>0;if(0===l.length)return c.None;{const f=i.ids,v=[];return i.ids=i.ids.filter((O,P)=>O in i.entities||(v.push(P),!1)),s(l,i),!d&&v.every(O=>i.ids[O]===f[O])?c.EntitiesOnly:c.Both}}function u(a,i){const l=[],d=[];for(const O of a){const P=C(O,t);P in i.entities?d.push({id:P,changes:O}):l.push(O)}const f=L(d,i),v=y(l,i);switch(!0){case v===c.None&&f===c.None:return c.None;case v===c.Both||f===c.Both:return c.Both;default:return c.EntitiesOnly}}function s(a,i){a.sort(o);const l=[];let d=0,f=0;for(;d<a.length&&f<i.ids.length;){const v=a[d],O=C(v,t),P=i.ids[f];o(v,i.entities[P])<=0?(l.push(O),d++):(l.push(P),f++)}i.ids=l.concat(d<a.length?a.slice(d).map(t):i.ids.slice(f)),a.forEach((v,O)=>{i.entities[t(v)]=v})}return{removeOne:n,removeMany:r,removeAll:p,addOne:m(h),updateOne:m(_),upsertOne:m(function b(a,i){return u([a],i)}),setAll:m(function x(a,i){return i.entities={},i.ids=[],y(a,i),c.Both}),setOne:m(I),setMany:m(function j(a,i){const l=a.map(d=>I(d,i));switch(!0){case l.some(d=>d===c.Both):return c.Both;case l.some(d=>d===c.EntitiesOnly):return c.EntitiesOnly;default:return c.None}}),addMany:m(y),updateMany:m(L),upsertMany:m(u),map:m(function H(a,i){return L(i.ids.reduce((d,f)=>{const v=a(i.entities[f]);return v!==i.entities[f]&&d.push({id:f,changes:v}),d},[]),i)}),mapOne:m(function Q({map:a,id:i},l){const d=l.entities[i];return d?_({id:i,changes:a(d)},l):c.None})}}(r,p):k(r);return Object.assign(Object.assign(Object.assign({selectId:r,sortComparer:p},h),y),x)}({selectId:function ce(t){return t.id},sortComparer:function de(t,o){return t.attachDate&&o.attachDate?t.attachDate<o.attachDate?1:-1:1}}),ue=U.getInitialState({uploading:!1}),pe=(0,g.Lq)(ue,(0,g.on)(S,(t,{file:o,fileId:n})=>{const r={attachDate:(new Date).getTime(),dateModified:o.lastModified,file:o,fileName:o.name,fileSize:o.size,id:n,completed:!1,progress:0};return U.addOne(r,Object.assign(Object.assign({},t),{uploading:!0}))}),(0,g.on)(w,(t,{fileId:o,progress:n})=>U.updateOne({id:o,changes:{progress:n}},Object.assign(Object.assign({},t),{uploading:!0}))),(0,g.on)(G,(t,{fileId:o})=>{const n={id:o,changes:{completed:!0,completedDate:(new Date).getTime()}};return U.updateOne(n,Object.assign(Object.assign({},t),{uploading:!1}))}));function fe(t,o){return pe(t,o)}const E=(0,g.ZF)(J),ge=((0,g.P1)(E,U.getSelectors().selectIds),(0,g.P1)(E,U.getSelectors().selectEntities),(0,g.P1)(E,U.getSelectors().selectAll)),me=((0,g.P1)(E,U.getSelectors().selectTotal),(0,g.P1)(E,t=>t.uploading));let he=(()=>{class t{constructor(n){this.store=n,this.filesUploadingAll$=this.store.select(ge),this.anyFilesUploading$=this.store.select(me)}attachFile(n,r){this.store.dispatch(z({file:n,fileId:r}))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(g.yh))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var F=M(7093),ye=M(7423),R=M(5245),Me=M(5899);let ve=(()=>{class t{constructor(){this.mode="indeterminate"}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["shared-loading-bar"]],inputs:{progress:"progress",mode:"mode"},decls:2,vars:3,consts:[[1,"parent"],[3,"mode","value","color"]],template:function(n,r){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"mat-progress-bar",1),e.qZA()),2&n&&(e.xp6(1),e.Q6J("mode",r.mode)("value",r.progress)("color",100===r.progress?"primary":"accent"))},directives:[Me.pW],styles:[".parent[_ngcontent-%COMP%]{height:100%}mat-progress-bar.mat-progress-bar[_ngcontent-%COMP%]{height:100%}"]}),t})();var Oe=M(837);function xe(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"shared-loading-bar",14),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("progress",n.file.progress)("mode","determinate")}}function Ce(t,o){1&t&&(e.ynx(0),e.TgZ(1,"div",15)(2,"div"),e._uU(3," Uploading... "),e.qZA()(),e.BQk())}function Ae(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4),e.YNc(4,xe,2,2,"ng-container",0),e.qZA(),e.TgZ(5,"div",5),e.YNc(6,Ce,4,0,"ng-container",6),e.qZA(),e.TgZ(7,"div",7),e._UZ(8,"img",8),e.qZA(),e.TgZ(9,"div",9),e._UZ(10,"hr"),e.qZA(),e.TgZ(11,"div",10)(12,"div",11)(13,"div",12),e._uU(14," File Name: "),e.qZA(),e.TgZ(15,"div",13),e._uU(16),e.qZA()(),e.TgZ(17,"div",11)(18,"div",12),e._uU(19," File Size: "),e.qZA(),e.TgZ(20,"div",13),e._uU(21),e.qZA()(),e.TgZ(22,"div",11)(23,"div",12),e._uU(24," Date modified: "),e.qZA(),e.TgZ(25,"div"),e._uU(26),e.ALo(27,"dateDisplay"),e.qZA()()()()(),e.BQk()),2&t){const n=e.oxw(),r=e.MAs(2);e.xp6(4),e.Q6J("ngIf",n.file.progress),e.xp6(2),e.Q6J("ngIf",n.file.progress<100)("ngIfElse",r),e.xp6(2),e.Q6J("src",n.imgPreview,e.LSH),e.xp6(8),e.hij(" ",n.file.fileName," "),e.xp6(5),e.hij(" ",n.file.fileSize," "),e.xp6(5),e.hij(" ",e.xi3(27,7,n.file.dateModified,"MDY")," ")}}function Ue(t,o){1&t&&(e.TgZ(0,"div",15)(1,"div",16)(2,"mat-icon",17),e._uU(3,"check_circle"),e.qZA()(),e.TgZ(4,"div"),e._uU(5," Completed "),e.qZA()())}let Ie=(()=>{class t{constructor(){this.reader=new FileReader}ngOnInit(){}ngOnChanges(n){var r,p,h;this.imgId!==n.file.currentValue.id&&(null===(r=this.file)||void 0===r?void 0:r.file)&&(this.reader.onload=y=>this.imgPreview=this.reader.result,this.reader.readAsDataURL(null===(p=this.file)||void 0===p?void 0:p.file)),this.imgId||(this.imgId=null===(h=this.file)||void 0===h?void 0:h.id)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-upload-item"]],inputs:{file:"file"},features:[e.TTD],decls:3,vars:1,consts:[[4,"ngIf"],["finished",""],[1,"file-parent"],[1,"card"],[1,"progress-parent"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px",1,"loading-status","poppins"],[4,"ngIf","ngIfElse"],[1,"image-parent"],[1,"preview-img",3,"src"],[1,"w-100"],["fxLayout","column","fxLayoutAlign","start start","fxLayoutGap","10px",1,"w-100","poppins","info-parent"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","5px",1,"info-line"],[1,"label"],[1,"value"],[3,"progress","mode"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px"],["fxLayout","column","fxLayoutAlign","center center"],[1,"done"]],template:function(n,r){1&n&&(e.YNc(0,Ae,28,10,"ng-container",0),e.YNc(1,Ue,6,0,"ng-template",null,1,e.W1O)),2&n&&e.Q6J("ngIf",r.file)},directives:[Z.O5,ve,F.xw,F.Wh,F.SQ,R.Hw],pipes:[Oe.o],styles:[".file-parent[_ngcontent-%COMP%]{margin-top:30px}.file-parent[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background-color:#ededf7}.file-parent[_ngcontent-%COMP%]   .loading-status[_ngcontent-%COMP%]{font-size:13px;height:25px}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]{height:15rem;width:100%;overflow:hidden;text-align:center}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]   .preview-img[_ngcontent-%COMP%]{height:100%}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]:hover{overflow:auto}.file-parent[_ngcontent-%COMP%]   .progress-parent[_ngcontent-%COMP%]{height:10px}.file-parent[_ngcontent-%COMP%]   .info-parent[_ngcontent-%COMP%]{padding:0 10px;height:7rem;overflow:hidden;font-size:13px}.file-parent[_ngcontent-%COMP%]   .info-parent[_ngcontent-%COMP%]:hover{overflow:auto}.file-parent[_ngcontent-%COMP%]   .info-line[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500}.file-parent[_ngcontent-%COMP%]   mat-icon.done[_ngcontent-%COMP%]{font-size:18px;color:#093;text-align:center;height:100%}.file-parent[_ngcontent-%COMP%]   mat-icon.progress[_ngcontent-%COMP%]{font-size:18px;color:#b38600;text-align:center;height:100%}"]}),t})();const Fe=["uploadInput"];function Pe(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"div",10),e._UZ(2,"app-upload-item",11),e.qZA(),e.BQk()),2&t){const n=o.$implicit;e.xp6(2),e.Q6J("file",n)}}function Te(t,o){if(1&t&&(e.ynx(0),e.TgZ(1,"section",8),e.YNc(2,Pe,3,1,"ng-container",9),e.qZA(),e.BQk()),2&t){const n=o.ngIf,r=e.oxw();e.xp6(2),e.Q6J("ngForOf",n)("ngForTrackBy",r.trackById)}}const Le=[{path:"",component:q,children:[{path:"",redirectTo:"upload",pathMatch:"full"},{path:"upload",component:(()=>{class t{constructor(n){this.fs=n}ngOnInit(){}onFileUpload(){var n;const r=null===(n=this.uploadInput)||void 0===n?void 0:n.nativeElement;r&&r.click()}onFileInputClick(n){var r;const p=null===(r=n.target)||void 0===r?void 0:r.files;p&&Object.keys(p).forEach(y=>{this.fs.attachFile(p[y],(new Date).getTime()+y+"")})}trackById(n,r){return r.id}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(he))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main-all"]],viewQuery:function(n,r){if(1&n&&e.Gf(Fe,5),2&n){let p;e.iGM(p=e.CRH())&&(r.uploadInput=p.first)}},decls:13,vars:3,consts:[[1,""],["type","file","multiple","",1,"upload-input",3,"change"],["uploadInput",""],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","15px",1,""],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","15px",1,"quicksand","upload-action",3,"click"],[1,"text"],["mat-fab","","color","primary","aria-label","Upload files"],[4,"ngIf"],["fxLayout","row wrap","fxLayoutAlign","start center","fxLayoutGap","15px",1,"w-100"],[4,"ngFor","ngForOf","ngForTrackBy"],["fxFlex","25"],[3,"file"]],template:function(n,r){1&n&&(e.TgZ(0,"div",0)(1,"input",1,2),e.NdJ("change",function(h){return r.onFileInputClick(h)}),e.qZA()(),e.TgZ(3,"div",3)(4,"div",4),e.NdJ("click",function(){return r.onFileUpload()}),e.TgZ(5,"div",5),e._uU(6," Select items to upload "),e.qZA(),e.TgZ(7,"div")(8,"button",6)(9,"mat-icon"),e._uU(10,"file_upload"),e.qZA()()()(),e.YNc(11,Te,3,2,"ng-container",7),e.ALo(12,"async"),e.qZA()),2&n&&(e.xp6(11),e.Q6J("ngIf",e.lcZ(12,1,r.fs.filesUploadingAll$)))},directives:[F.xw,F.Wh,F.SQ,ye.lW,R.Hw,Z.O5,Z.sg,F.yH,Ie],pipes:[Z.Ov],styles:[".upload-action[_ngcontent-%COMP%]{border:1px solid #ccc;padding:5px 25px;border-radius:30px;background-color:#e6f2ff;cursor:pointer}.upload-action[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:20px}.upload-input[_ngcontent-%COMP%]{display:none;height:0px}"]}),t})(),data:{pageTitle:"Upload Files"}}]}];let Ze=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[B.Bz.forChild(Le)],B.Bz]}),t})();var N=M(4004),Ee=M(5577),_e=M(5698),be=M(9300),Be=M(2805);const Se=[(()=>{class t{constructor(n){this.actions$=n,this.attachFileForUpload$=(0,A.GW)(()=>this.actions$.pipe((0,A.l4)(z),(0,N.U)(r=>{const p=r.file,h=r.fileId;return console.log(h),S({fileId:h,file:p})})),{dispatch:!0}),this.uploadFileStart$=(0,A.GW)(()=>this.actions$.pipe((0,A.l4)(S),(0,Ee.z)(r=>{const p=r.fileId;return(0,Be.H)(0,500).pipe((0,_e.q)(10),(0,N.U)(y=>w({fileId:p,progress:10*(y+1)})))}))),this.uploadFileFinished$=(0,A.GW)(()=>this.actions$.pipe((0,A.l4)(w),(0,be.h)(r=>100===r.progress),(0,N.U)(r=>G({fileId:r.fileId}))))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(A.eX))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})()];let we=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[],imports:[[X.n,$,W.d,g.Aw.forFeature(J,fe),A.sQ.forFeature(Se),Ze]]}),t})()}}]);