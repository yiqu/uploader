"use strict";(self.webpackChunkuploader=self.webpackChunkuploader||[]).push([[410],{7410:(Qn,dt,_)=>{_.r(dt),_.d(dt,{MainModule:()=>Nn});var X=_(3271),v=_(6991),l=_(5620),Mt=_(61),Ft=_(7462),It=_(4987),W=_(1402),t=_(5e3);let St=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-main"]],decls:2,vars:0,consts:[[1,"container-fluid","mb-5","mt-3"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"router-outlet"),t.qZA())},directives:[W.lC],styles:[""]}),e})();var Y=_(5698);const gt=(0,l.PH)("[Upload/UI] attach a file",(0,l.Ky)()),ft=(0,l.PH)("[Upload/UI] Remove all attached files"),V=(0,l.PH)("[Upload/API] Upload file start",(0,l.Ky)()),tt=(0,l.PH)("[Upload/API] Upload file successful",(0,l.Ky)()),mt=(0,l.PH)("[Upload/API] Upload file failed",(0,l.Ky)()),et=(0,l.PH)("[Upload/API] Upload file progress update",(0,l.Ky)()),nt=(0,l.PH)("[Upload/API] Update new photo in user DB start",(0,l.Ky)()),ot=(0,l.PH)("[Upload/API] Update new photo in user DB successful",(0,l.Ky)()),_t=(0,l.PH)("[Upload/API] Update new photo in user DB failed",(0,l.Ky)()),z=(0,l.PH)("[Upload/API] Get user files start",(0,l.Ky)()),ht=(0,l.PH)("[Upload/API] Get user files successful",(0,l.Ky)()),jt=(0,l.PH)("[Upload/API] Get user files failed",(0,l.Ky)()),yt=(0,l.PH)("[Upload/API] User is not logged in to fetch files"),xt="uploadFiles",Ut="userFiles";var g=(()=>{return(e=g||(g={}))[e.EntitiesOnly=0]="EntitiesOnly",e[e.Both=1]="Both",e[e.None=2]="None",g;var e})();function x(e){return function(n,i){const s={ids:[...i.ids],entities:Object.assign({},i.entities)},a=e(n,s);return a===g.Both?Object.assign({},i,s):a===g.EntitiesOnly?Object.assign(Object.assign({},i),{entities:s.entities}):i}}function b(e,o){const n=o(e);return(0,t.X6Q)()&&void 0===n&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",e,"The `selectId` implementation:",o.toString()),n}function vt(e){function o(m,u){const c=b(m,e);return c in u.entities?g.None:(u.ids.push(c),u.entities[c]=m,g.Both)}function n(m,u){let c=!1;for(const r of m)c=o(r,u)!==g.None||c;return c?g.Both:g.None}function s(m,u){const c=b(m,e);return c in u.entities?(u.entities[c]=m,g.EntitiesOnly):(u.ids.push(c),u.entities[c]=m,g.Both)}function U(m,u){const r=(m instanceof Array?m:u.ids.filter(d=>m(u.entities[d]))).filter(d=>d in u.entities).map(d=>delete u.entities[d]).length>0;return r&&(u.ids=u.ids.filter(d=>d in u.entities)),r?g.Both:g.None}function F(m,u){return P([m],u)}function P(m,u){const c={};return(m=m.filter(d=>d.id in u.entities)).length>0?m.filter(f=>function S(m,u,c){const d=Object.assign({},c.entities[u.id],u.changes),f=b(d,e),h=f!==u.id;return h&&(m[u.id]=f,delete c.entities[u.id]),c.entities[f]=d,h}(c,f,u)).length>0?(u.ids=u.ids.map(f=>c[f]||f),g.Both):g.EntitiesOnly:g.None}function D(m,u){const c=[],r=[];for(const h of m){const A=b(h,e);A in u.entities?r.push({id:A,changes:h}):c.push(h)}const d=P(r,u),f=n(c,u);switch(!0){case f===g.None&&d===g.None:return g.None;case f===g.Both||d===g.Both:return g.Both;default:return g.EntitiesOnly}}return{removeAll:function T(m){return Object.assign({},m,{ids:[],entities:{}})},addOne:x(o),addMany:x(n),setAll:x(function i(m,u){return u.ids=[],u.entities={},n(m,u),g.Both}),setOne:x(s),setMany:x(function a(m,u){const c=m.map(r=>s(r,u));switch(!0){case c.some(r=>r===g.Both):return g.Both;case c.some(r=>r===g.EntitiesOnly):return g.EntitiesOnly;default:return g.None}}),updateOne:x(F),updateMany:x(P),upsertOne:x(function L(m,u){return D([m],u)}),upsertMany:x(D),removeOne:x(function p(m,u){return U([m],u)}),removeMany:x(U),map:x(function w(m,u){return P(u.ids.reduce((d,f)=>{const h=m(u.entities[f]);return h!==u.entities[f]&&d.push({id:f,changes:h}),d},[]).filter(({id:d})=>d in u.entities),u)}),mapOne:x(function K({map:m,id:u},c){const r=c.entities[u];return r?F({id:u,changes:m(r)},c):g.None})}}function At(e={}){var o,n;const{selectId:i,sortComparer:s}={selectId:null!==(o=e.selectId)&&void 0!==o?o:T=>T.id,sortComparer:null!==(n=e.sortComparer)&&void 0!==n&&n},a=function zt(){return{getInitialState:function e(o={}){return Object.assign({ids:[],entities:{}},o)}}}(),p=function qt(){return{getSelectors:function e(o){const n=p=>p.ids,i=p=>p.entities,s=(0,l.P1)(n,i,(p,U)=>p.map(T=>U[T])),a=(0,l.P1)(n,p=>p.length);return o?{selectIds:(0,l.P1)(o,n),selectEntities:(0,l.P1)(o,i),selectAll:(0,l.P1)(o,s),selectTotal:(0,l.P1)(o,a)}:{selectIds:n,selectEntities:i,selectAll:s,selectTotal:a}}}}(),U=s?function $t(e,o){const{removeOne:n,removeMany:i,removeAll:s}=vt(e);function a(c,r){return p([c],r)}function p(c,r){const d=c.filter(f=>!(b(f,e)in r.entities));return 0===d.length?g.None:(u(d,r),g.Both)}function T(c,r){const d=b(c,e);return d in r.entities?(r.ids=r.ids.filter(f=>f!==d),u([c],r),g.Both):a(c,r)}function F(c,r){return w([c],r)}function w(c,r){const d=[],f=c.filter(h=>function P(c,r,d){if(!(r.id in d.entities))return!1;const h=Object.assign({},d.entities[r.id],r.changes),A=b(h,e);return delete d.entities[r.id],c.push(h),A!==r.id}(d,h,r)).length>0;if(0===d.length)return g.None;{const h=r.ids,A=[];return r.ids=r.ids.filter((I,N)=>I in r.entities||(A.push(N),!1)),u(d,r),!f&&A.every(I=>r.ids[I]===h[I])?g.EntitiesOnly:g.Both}}function m(c,r){const d=[],f=[];for(const I of c){const N=b(I,e);N in r.entities?f.push({id:N,changes:I}):d.push(I)}const h=w(f,r),A=p(d,r);switch(!0){case A===g.None&&h===g.None:return g.None;case A===g.Both||h===g.Both:return g.Both;default:return g.EntitiesOnly}}function u(c,r){c.sort(o);const d=[];let f=0,h=0;for(;f<c.length&&h<r.ids.length;){const A=c[f],I=b(A,e),N=r.ids[h];o(A,r.entities[N])<=0?(d.push(I),f++):(d.push(N),h++)}r.ids=d.concat(f<c.length?c.slice(f).map(e):r.ids.slice(h)),c.forEach((A,I)=>{r.entities[e(A)]=A})}return{removeOne:n,removeMany:i,removeAll:s,addOne:x(a),updateOne:x(F),upsertOne:x(function D(c,r){return m([c],r)}),setAll:x(function U(c,r){return r.entities={},r.ids=[],p(c,r),g.Both}),setOne:x(T),setMany:x(function S(c,r){const d=c.map(f=>T(f,r));switch(!0){case d.some(f=>f===g.Both):return g.Both;case d.some(f=>f===g.EntitiesOnly):return g.EntitiesOnly;default:return g.None}}),addMany:x(p),updateMany:x(w),upsertMany:x(m),map:x(function K(c,r){return w(r.ids.reduce((f,h)=>{const A=c(r.entities[h]);return A!==r.entities[h]&&f.push({id:h,changes:A}),f},[]),r)}),mapOne:x(function L({map:c,id:r},d){const f=d.entities[r];return f?F({id:r,changes:c(f)},d):g.None})}}(i,s):vt(i);return Object.assign(Object.assign(Object.assign({selectId:i,sortComparer:s},a),p),U)}const Z=At({selectId:function Kt(e){return e.id},sortComparer:function Xt(e,o){return e.attachDate&&o.attachDate?e.attachDate<o.attachDate?1:-1:1}}),Vt=Z.getInitialState({apiWorking:!1,filesUploadedAndUrlAddedToDb:[],errMsg:void 0,error:!1}),te=(0,l.Lq)(Vt,(0,l.on)(ft,e=>Z.removeAll(Object.assign(Object.assign({},e),{apiWorking:!1,error:!1,errMsg:void 0,filesUploadedAndUrlAddedToDb:[]}))),(0,l.on)(V,(e,{file:o,fileId:n})=>{const i={attachDate:(new Date).getTime(),dateModified:o.lastModified,file:o,fileName:o.name,fileSize:o.size,id:n,completed:!1,progress:0,downloadUrl:void 0};return Z.addOne(i,Object.assign(Object.assign({},e),{apiWorking:!0}))}),(0,l.on)(et,(e,{fileId:o,progress:n,downloadUrl:i})=>{var s,a;const p={id:o,changes:{progress:null!=n?n:null===(s=e.entities[o])||void 0===s?void 0:s.progress,downloadUrl:null!=i?i:null===(a=e.entities[o])||void 0===a?void 0:a.downloadUrl}};return Z.updateOne(p,Object.assign(Object.assign({},e),{apiWorking:!0}))}),(0,l.on)(tt,(e,{fileId:o})=>{const n={id:o,changes:{completed:!0,completedDate:(new Date).getTime()}};return Z.updateOne(n,Object.assign(Object.assign({},e),{apiWorking:!1}))}),(0,l.on)(mt,(e,{errMsg:o})=>Object.assign(Object.assign({},e),{apiWorking:!1,error:!0,errMsg:o})),(0,l.on)(nt,(e,{photoData:o})=>Z.updateOne({id:o.id,changes:{urlUploaded:!1}},Object.assign(Object.assign({},e),{apiWorking:!0}))),(0,l.on)(ot,(e,{photoData:o})=>{var n;const i={id:o.id,changes:{urlUploaded:!0}},s=[...null!==(n=e.filesUploadedAndUrlAddedToDb)&&void 0!==n?n:[]];return s.push(o),Z.updateOne(i,Object.assign(Object.assign({},e),{apiWorking:!1,filesUploadedAndUrlAddedToDb:s}))}),(0,l.on)(_t,(e,{errMsg:o})=>Object.assign(Object.assign({},e),{apiWorking:!1,error:!0,errMsg:o})));function ee(e,o){return te(e,o)}const B=(0,l.ZF)(xt),Ot=((0,l.P1)(B,Z.getSelectors().selectIds),(0,l.P1)(B,Z.getSelectors().selectEntities),(0,l.P1)(B,Z.getSelectors().selectAll)),ne=(0,l.P1)(B,Z.getSelectors().selectTotal),oe=(0,l.P1)(B,e=>e.apiWorking),it=(0,l.P1)(B,e=>e.filesUploadedAndUrlAddedToDb),ie=(0,l.P1)(ne,it,(e,o)=>e===o.length),ae=(0,l.P1)(Ot,it,(e,o)=>({total:e,uploadings:o})),E=At({selectId:function se(e){return e.id},sortComparer:function re(e,o){return e.dateUploaded&&o.dateUploaded?e.dateUploaded<o.dateUploaded?1:-1:1}}),le=E.getInitialState({apiWorking:!1,errMsg:void 0,error:!1}),ce=(0,l.Lq)(le,(0,l.on)(z,e=>Object.assign(Object.assign({},e),{apiWorking:!0})),(0,l.on)(ht,(e,{files:o})=>E.setAll(o,Object.assign(Object.assign({},e),{apiWorking:!1}))),(0,l.on)(yt,e=>E.removeAll(Object.assign(Object.assign({},e),{apiWorking:!1}))));function pe(e,o){return ce(e,o)}var ue=_(5839);const Q=(0,l.ZF)(Ut),de=((0,l.P1)(Q,E.getSelectors().selectIds),(0,l.P1)(Q,E.getSelectors().selectEntities),(0,l.P1)(Q,E.getSelectors().selectAll)),ge=(0,l.P1)(Q,E.getSelectors().selectTotal),fe=(0,l.P1)(Q,ue.t0,(e,o)=>e.apiWorking||!!o),me=(0,l.P1)(Q,e=>e.apiWorking),_e=(0,l.P1)(de,e=>{if(e&&e.length>0){const o=[...e];return o.sort((i,s)=>i.dateUploaded>s.dateUploaded?-1:1),o.slice(0,5)}return[]});var he=_(5439);let at=(()=>{class e{constructor(n){this.storage=n}uploadBlob(n,i){const s="uploader-app/"+this.getCurrentTime()+"/"+i,a=this.storage.ref(s),p=a.put(n);return{ref:a,task:p}}getCurrentTime(){return he().format("MM-DD-YYYY")}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(X.Q1))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var C=_(5265),st=_(2843),M=_(4004),R=_(262);let xe=(()=>{class e{constructor(n,i){this.firestore=n,this.storage=i}createDocument(n,i){const s=(0,C.JU)(this.firestore,"uploader/"+i);return(0,C.pl)(s,n)}updateDocument(n){if(n){const i=(0,C.JU)(this.firestore,"uploader/");return(0,C.r7)(i,{amount:n})}return Promise.resolve()}addDocumentToCollection(n,i){const s=(0,C.JU)((0,C.hJ)(this.firestore,"uploader/"+i)),a=s.id,p=Object.assign(Object.assign({},n),{id:a});return{operationObs:(0,C.pl)(s,p),id:a}}getDocument(n){const i=(0,C.JU)(this.firestore,"uploader/"+n);return(0,C.KO)(i).pipe((0,Y.q)(1),(0,M.U)(s=>s.data()),(0,R.K)(s=>(console.error(s),(0,st._)(()=>{const a=new Error(s);return a.timestamp=Date.now(),a}))))}getDataByCollectionName(n){const i=(0,C.hJ)(this.firestore,"uploader/");return(0,C.$k)(i).pipe((0,Y.q)(1),(0,R.K)(s=>(console.error(s),(0,st._)(()=>{const a=new Error(s);return a.timestamp=Date.now(),a}))),(0,M.U)(s=>s.map(a=>{const p=a.data();return Object.assign({id:a.id},p)})))}getCollection(n){const i=(0,C.hJ)(this.firestore,"uploader/"+n);return(0,C.$k)(i).pipe((0,Y.q)(1),(0,R.K)(s=>(console.error(s),(0,st._)(()=>{const a=new Error(s);return a.timestamp=Date.now(),a}))),(0,M.U)(s=>s.map(a=>{const p=a.data();return Object.assign({},p)})))}uploadBlob(n){return this.storage.ref("folder-1").put(n)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(C.gg),t.LFG(X.Q1))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),G=(()=>{class e{constructor(n,i,s){this.store=n,this.ss=i,this.rs=s,this.filesUploadingAll$=this.store.select(Ot),this.anyFilesUploading$=this.store.select(oe),this.filesUploaded$=this.store.select(it),this.isFilesUploadFinished$=this.store.select(ie),this.uploadingsAndTotalFiles$=this.store.select(ae),this.userFilesApiLoading$=this.store.select(fe),this.userFileApiWorking$=this.store.select(me),this.userFilesCount$=this.store.select(ge),this.userRecentUploads$=this.store.select(_e)}attachFile(n,i){this.store.dispatch(gt({file:n,fileId:i}))}cleanUpAttachedFiles(){this.store.dispatch(ft())}uploadFile(n,i){return this.ss.uploadBlob(n,i)}addPhotoUrl(n,i){return this.rs.addDocumentToCollection(n,i+"/photos")}getUserPhotos(n){return this.rs.getCollection(n+"/photos")}getUserFiles(){return this.store.dispatch(z({user:void 0}))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(l.yh),t.LFG(at),t.LFG(xe))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var q=_(3702),Lt=_(3003),rt=_(1271),lt=_(8966),j=(()=>{return(e=j||(j={})).MINIMIZE="minimize",e.MAXIMIZE="maximize",e.CLOSE="close",j;var e})(),y=_(7093),ct=_(7423),H=_(5245),O=_(9808),Ue=_(655),ve=_(8603);class k{transform(o,n){if(o){let i=o.slice(0,n);return n>=o.length?o:i+".."}return o+""}}k.\u0275fac=function(o){return new(o||k)},k.\u0275pipe=t.Yjl({name:"stringSliceCutoff",type:k,pure:!0}),(0,Ue.gn)([(0,ve.Z)()],k.prototype,"transform",null);var pt=_(4836),J=_(837);function Ae(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",10),t._uU(2),t.qZA(),t.TgZ(3,"div",11)(4,"mat-icon",12),t._uU(5,"task_alt"),t.qZA()(),t.BQk()),2&e){const n=t.oxw().ngIf;t.xp6(2),t.AsE(" ",n.uploadings.length," / ",n.total.length," files uploaded ")}}function Oe(e,o){if(1&e&&(t.TgZ(0,"div",10),t._uU(1),t.qZA(),t.TgZ(2,"mat-icon",13),t._uU(3,"hourglass_bottom"),t.qZA()),2&e){const n=t.oxw().ngIf;t.xp6(1),t.AsE(" Uploading: ",n.uploadings.length," / ",n.total.length," ")}}function Le(e,o){if(1&e&&(t.ynx(0),t.YNc(1,Ae,6,2,"ng-container",6),t.ALo(2,"async"),t.YNc(3,Oe,4,2,"ng-template",null,9,t.W1O),t.BQk()),2&e){const n=t.MAs(4),i=t.oxw(3);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,i.data.isFilesUploadFinished))("ngIfElse",n)}}function Ce(e,o){if(1&e&&(t.ynx(0),t._UZ(1,"img",23),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("src",null==n?null:n.downloadUrl,t.LSH)}}function Te(e,o){1&e&&(t.TgZ(0,"mat-icon",24),t._uU(1," cloud_upload "),t.qZA())}function Pe(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",15)(2,"div"),t.YNc(3,Ce,2,1,"ng-container",6),t.YNc(4,Te,2,0,"ng-template",null,16,t.W1O),t.qZA(),t.TgZ(6,"div",17)(7,"div",18)(8,"a",19),t._uU(9),t.ALo(10,"stringSliceCutoff"),t.qZA(),t.TgZ(11,"div",20),t._uU(12),t.qZA()(),t.TgZ(13,"div",21)(14,"div"),t._uU(15),t.ALo(16,"fileSizeDisplay"),t.qZA(),t.TgZ(17,"div",22),t.ALo(18,"dateDisplay"),t._uU(19),t.ALo(20,"dateFromNow"),t.qZA()()()(),t.BQk()),2&e){const n=o.$implicit,i=t.MAs(5);t.xp6(3),t.Q6J("ngIf",null==n?null:n.downloadUrl)("ngIfElse",i),t.xp6(4),t.Q6J("title",null==n?null:n.fileName),t.xp6(1),t.Q6J("href",null==n?null:n.downloadUrl,t.LSH),t.xp6(1),t.hij(" ",t.xi3(10,9,null==n?null:n.fileName,25)," - "),t.xp6(3),t.hij(" ",n.progress,"% "),t.xp6(3),t.hij(" ",t.lcZ(16,12,null==n?null:n.fileSize)," - "),t.xp6(2),t.Q6J("title",t.xi3(18,14,null==n?null:n.attachDate,"FULLDATE")),t.xp6(2),t.hij(" ",t.lcZ(20,17,null==n?null:n.attachDate)," ")}}function Ze(e,o){if(1&e&&(t.ynx(0),t.YNc(1,Pe,21,19,"ng-container",14),t.BQk()),2&e){const n=o.ngIf;t.xp6(1),t.Q6J("ngForOf",n)}}function Me(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",7),t.YNc(2,Le,5,4,"ng-container",4),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"div",8),t.YNc(5,Ze,2,1,"ng-container",4),t.ALo(6,"async"),t.qZA(),t.BQk()),2&e){const n=t.oxw(2);t.xp6(2),t.Q6J("ngIf",t.lcZ(3,2,n.data.uploadingsAndTotalFiles)),t.xp6(3),t.Q6J("ngIf",t.lcZ(6,4,n.data.fileStatus))}}function Fe(e,o){if(1&e&&(t.ynx(0),t.YNc(1,Me,7,6,"ng-container",6),t.BQk()),2&e){const n=o.ngIf;t.oxw();const i=t.MAs(16);t.xp6(1),t.Q6J("ngIf",n.length>0)("ngIfElse",i)}}function Ie(e,o){1&e&&(t.TgZ(0,"div",25),t._uU(1," Upload queue is empty. "),t.qZA())}let Se=(()=>{class e{constructor(n,i){this.dialogRef=n,this.data=i,this.minimize=j.MINIMIZE,this.close=j.CLOSE}ngOnInit(){}onDialogClose(n){this.dialogRef.close({action:n})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(lt.so),t.Y36(lt.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["progress-dialog-display"]],decls:17,vars:3,consts:[["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","0px"],["fxLayout","row","fxLayoutAlign","space-between center",1,"title","quicksand","fw-500","w-100"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","1px"],["mat-icon-button","",3,"click"],[4,"ngIf"],["nothingUploading",""],[4,"ngIf","ngIfElse"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",1,"content","w-100","bb-1"],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","10px",1,"content","w-100"],["uploading",""],[1,""],["fxLayout","column","fxLayoutAlign","center center",1,""],[1,"text-success"],[1,"text-primary"],[4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","15px",1,"w-100"],["imgPlaceholder",""],["fxLayout","column","fxLayoutAlign","center start","fxLayoutGap","5px"],["fxLayout","row","fxLayoutAlign","start start","fxLayoutGap","5px",3,"title"],["target","_blank","rel","noopener noreferrer",1,"stateful",3,"href"],[1,"fw-500","percent"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","5px",1,"meta"],[1,"date",3,"title"],["alt","Photo img","width","50","height","50",3,"src"],[1,"pic-progress"],["fxLayout","row","fxLayoutAlign","start center",1,"content","w-100"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div"),t._uU(3," Upload Progress "),t.qZA(),t.TgZ(4,"div",2)(5,"div")(6,"button",3),t.NdJ("click",function(){return i.onDialogClose(i.minimize)}),t.TgZ(7,"mat-icon"),t._uU(8,"minimize"),t.qZA()()(),t.TgZ(9,"div")(10,"button",3),t.NdJ("click",function(){return i.onDialogClose(i.close)}),t.TgZ(11,"mat-icon"),t._uU(12,"close"),t.qZA()()()()(),t.YNc(13,Fe,2,2,"ng-container",4),t.ALo(14,"async"),t.qZA(),t.YNc(15,Ie,2,0,"ng-template",null,5,t.W1O)),2&n&&(t.xp6(13),t.Q6J("ngIf",t.lcZ(14,1,i.data.fileStatus)))},directives:[y.xw,y.Wh,y.SQ,ct.lW,H.Hw,O.O5,O.sg],pipes:[O.Ov,k,pt.nV,J.o,J.G],styles:[".title[_ngcontent-%COMP%]{background-color:#2a2961;color:#fff;padding:20px}.content[_ngcontent-%COMP%]{padding:15px}.content[_ngcontent-%COMP%]   .percent[_ngcontent-%COMP%]{color:#093}.content[_ngcontent-%COMP%]   mat-icon.pic-progress[_ngcontent-%COMP%]{color:#517e5d}"]}),e})(),we=(()=>{class e{constructor(n){this.dialog=n}openDialog(n){var i;return null===(i=this.displayRef)||void 0===i||i.close(),this.displayRef=this.dialog.open(Se,{minWidth:"calc(100% - 50rem)",height:"calc(100% - 10rem)",panelClass:"progress-dialog-display",data:n,autoFocus:!1}),this.displayRef.afterClosed().pipe((0,Y.q)(1)).subscribe(s=>{console.log(s)}),this.displayRef}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(lt.uw))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function be(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",8),t._uU(2),t.qZA(),t.TgZ(3,"div",9)(4,"mat-icon",10),t._uU(5,"task_alt"),t.qZA()(),t.BQk()),2&e){const n=t.oxw(2).ngIf;t.xp6(2),t.AsE(" ",n.uploadings.length," / ",n.total.length," files uploaded ")}}function De(e,o){if(1&e&&(t.TgZ(0,"div",8),t._uU(1),t.qZA(),t.TgZ(2,"mat-icon",11),t._uU(3,"hourglass_bottom"),t.qZA()),2&e){const n=t.oxw(2).ngIf;t.xp6(1),t.AsE(" Uploading: ",n.uploadings.length," / ",n.total.length," ")}}function Ee(e,o){if(1&e&&(t.ynx(0),t.YNc(1,be,6,2,"ng-container",5),t.ALo(2,"async"),t.YNc(3,De,4,2,"ng-template",null,7,t.W1O),t.BQk()),2&e){const n=t.MAs(4),i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,i.data.isFilesUploadFinished))("ngIfElse",n)}}function ke(e,o){1&e&&t._uU(0," Upload queue is empty. ")}function Ne(e,o){if(1&e&&(t.ynx(0),t.YNc(1,Ee,5,4,"ng-container",5),t.YNc(2,ke,1,0,"ng-template",null,6,t.W1O),t.BQk()),2&e){const n=o.ngIf,i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.uploadings.length>0)("ngIfElse",i)}}let Be=(()=>{class e{constructor(n,i,s){this.data=n,this.progressRef=i,this.pds=s}ngOnInit(){}onMaximizeClick(){this.pds.openDialog({fileStatus:this.data.fileStatus,isFilesUploadFinished:this.data.isFilesUploadFinished,uploadingsAndTotalFiles:this.data.uploadingsAndTotalFiles})}onCloseSnackbarClick(){}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(rt.qD),t.Y36(rt.OX),t.Y36(we))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-shared-progress-snackbar"]],decls:13,vars:3,consts:[["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","0px",1,"w-100"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","5px"],[4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","1px"],["mat-icon-button","",3,"click"],[4,"ngIf","ngIfElse"],["emptyQueue",""],["uploading",""],[1,""],["fxLayout","column","fxLayoutAlign","center center",1,""],[1,"text-success"],[1,"text-primary"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Ne,4,2,"ng-container",2),t.ALo(3,"async"),t.qZA(),t.TgZ(4,"div",3)(5,"div")(6,"button",4),t.NdJ("click",function(){return i.onMaximizeClick()}),t.TgZ(7,"mat-icon"),t._uU(8,"maximize"),t.qZA()()(),t.TgZ(9,"div")(10,"button",4),t.NdJ("click",function(){return i.onCloseSnackbarClick()}),t.TgZ(11,"mat-icon"),t._uU(12,"close"),t.qZA()()()()()),2&n&&(t.xp6(2),t.Q6J("ngIf",t.lcZ(3,1,i.data.uploadingsAndTotalFiles)))},directives:[y.xw,y.Wh,y.SQ,O.O5,H.Hw,ct.lW],pipes:[O.Ov],styles:[""]}),e})(),Qe=(()=>{class e{constructor(n){this.snackBar=n,this.defaultHorizontalPosition="center",this.defaultVerticalPosition="bottom"}getProgressSnackbar(n){var i;return null===(i=this.currentSnackbarRef)||void 0===i||i.dismiss(),this.currentSnackbarRef=this.snackBar.openFromComponent(Be,{horizontalPosition:this.defaultHorizontalPosition,verticalPosition:this.defaultVerticalPosition,duration:0,panelClass:"progress-snackbar",data:n}),this.currentSnackbarRef}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(rt.ux))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var He=_(5899);let We=(()=>{class e{constructor(){this.mode="indeterminate"}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["shared-loading-bar"]],inputs:{progress:"progress",mode:"mode"},decls:2,vars:3,consts:[[1,"parent"],[3,"mode","value","color"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"mat-progress-bar",1),t.qZA()),2&n&&(t.xp6(1),t.Q6J("mode",i.mode)("value",i.progress)("color",100===i.progress?"primary":"accent"))},directives:[He.pW],styles:[".parent[_ngcontent-%COMP%]{height:100%}mat-progress-bar.mat-progress-bar[_ngcontent-%COMP%]{height:100%;border-radius:30px}"]}),e})();function Ye(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",15)(2,"div"),t._uU(3),t.qZA()(),t.BQk()),2&e){const n=t.oxw(2);t.xp6(3),t.hij(" Uploading ( ",n.file.progress,"% ) ")}}function Re(e,o){if(1&e&&(t.ynx(0),t._UZ(1,"shared-loading-bar",16),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("progress",n.file.progress)("mode","determinate")}}function Ge(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",17),t._UZ(2,"img",18),t.qZA(),t.BQk()),2&e){const n=t.oxw(2);t.xp6(2),t.Q6J("src",n.imgPreview,t.LSH)}}function je(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"a",19),t._uU(2,"Click here"),t.qZA(),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("href",n.file.downloadUrl,t.LSH)}}function Je(e,o){1&e&&t._uU(0," Creating URL... ")}function ze(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",3)(2,"div",4)(3,"div",5),t.YNc(4,Ye,4,1,"ng-container",6),t.qZA(),t.TgZ(5,"div",7)(6,"div",8),t.YNc(7,Re,2,2,"ng-container",0),t.qZA()(),t.YNc(8,Ge,3,1,"ng-container",6),t.TgZ(9,"div",9),t._UZ(10,"hr"),t.qZA(),t.TgZ(11,"div",10)(12,"div",11)(13,"div",12),t._uU(14," File Name: "),t.qZA(),t.TgZ(15,"div",13),t._uU(16),t.qZA()(),t.TgZ(17,"div",11)(18,"div",12),t._uU(19," File Size: "),t.qZA(),t.TgZ(20,"div",13),t._uU(21),t.ALo(22,"fileSizeDisplay"),t.qZA()(),t.TgZ(23,"div",11)(24,"div",12),t._uU(25," Date modified: "),t.qZA(),t.TgZ(26,"div"),t._uU(27),t.ALo(28,"dateDisplay"),t.qZA()(),t.TgZ(29,"div",11)(30,"div",12),t._uU(31," Download URL: "),t.qZA(),t.TgZ(32,"div"),t.YNc(33,je,3,1,"ng-container",6),t.YNc(34,Je,1,0,"ng-template",null,14,t.W1O),t.qZA()()()()(),t.BQk()),2&e){const n=t.MAs(35),i=t.oxw(),s=t.MAs(2),a=t.MAs(4);t.xp6(4),t.Q6J("ngIf",i.file.progress<100)("ngIfElse",s),t.xp6(3),t.Q6J("ngIf",i.file.progress),t.xp6(1),t.Q6J("ngIf",i.isImgType)("ngIfElse",a),t.xp6(8),t.hij(" ",i.file.fileName," "),t.xp6(5),t.hij(" ",t.lcZ(22,10,i.file.fileSize)," "),t.xp6(6),t.hij(" ",t.xi3(28,12,i.file.dateModified,"MDY")," "),t.xp6(6),t.Q6J("ngIf",i.file.downloadUrl)("ngIfElse",n)}}function qe(e,o){1&e&&(t.TgZ(0,"div",15)(1,"div",20)(2,"mat-icon",21),t._uU(3,"check_circle"),t.qZA()(),t.TgZ(4,"div"),t._uU(5," Completed "),t.qZA()())}function $e(e,o){1&e&&(t.TgZ(0,"div",17)(1,"mat-icon",22),t._uU(2," description "),t.qZA()())}const Ke=["image/jpeg","image/png","image/gif"];let Xe=(()=>{class e{constructor(){this.isImgType=!1,this.reader=new FileReader}ngOnInit(){}ngOnChanges(n){var i,s,a;this.imgId!==n.file.currentValue.id&&(null===(i=this.file)||void 0===i?void 0:i.file)&&(this.isImgType=!!Ke.includes(this.file.file.type),this.reader.onload=p=>this.imgPreview=this.reader.result,this.reader.readAsDataURL(null===(s=this.file)||void 0===s?void 0:s.file)),this.imgId||(this.imgId=null===(a=this.file)||void 0===a?void 0:a.id)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-upload-item"]],inputs:{file:"file"},features:[t.TTD],decls:5,vars:1,consts:[[4,"ngIf"],["finished",""],["notImg",""],[1,"file-parent"],[1,"card"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px",1,"loading-status","poppins"],[4,"ngIf","ngIfElse"],["fxLayout","row","fxLayoutAlign","center center"],[1,"progress-parent"],[1,"w-100"],["fxLayout","column","fxLayoutAlign","start start","fxLayoutGap","5px",1,"w-100","poppins","info-parent"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",1,"info-line"],[1,"label"],[1,"value"],["noUrl",""],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px"],[3,"progress","mode"],[1,"image-parent"],[1,"preview-img",3,"src"],["download","hi",3,"href"],["fxLayout","column","fxLayoutAlign","center center"],[1,"done"],["fxLayout","row","fxLayoutAlign","center center",1,"file-icon"]],template:function(n,i){1&n&&(t.YNc(0,ze,36,15,"ng-container",0),t.YNc(1,qe,6,0,"ng-template",null,1,t.W1O),t.YNc(3,$e,3,0,"ng-template",null,2,t.W1O)),2&n&&t.Q6J("ngIf",i.file)},directives:[O.O5,y.xw,y.Wh,y.SQ,We,H.Hw],pipes:[pt.nV,J.o],styles:[".file-parent[_ngcontent-%COMP%]{margin-top:15px}.file-parent[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border-top-right-radius:25px;border-top-left-radius:25px;background-color:#ededf7}.file-parent[_ngcontent-%COMP%]   .loading-status[_ngcontent-%COMP%]{font-size:13px;height:2rem}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]{height:15rem;width:100%;overflow:hidden;text-align:center}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]   .preview-img[_ngcontent-%COMP%]{height:100%}.file-parent[_ngcontent-%COMP%]   .image-parent[_ngcontent-%COMP%]:hover{overflow:auto}.file-parent[_ngcontent-%COMP%]   .progress-parent[_ngcontent-%COMP%]{height:10px;width:97%;margin-bottom:8px}.file-parent[_ngcontent-%COMP%]   .info-parent[_ngcontent-%COMP%]{padding:0 10px 10px;height:7rem;overflow:hidden;font-size:11px}.file-parent[_ngcontent-%COMP%]   .info-parent[_ngcontent-%COMP%]:hover{overflow:auto}.file-parent[_ngcontent-%COMP%]   .info-line[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500}.file-parent[_ngcontent-%COMP%]   mat-icon.done[_ngcontent-%COMP%]{font-size:18px;color:#093;text-align:center;height:100%}.file-parent[_ngcontent-%COMP%]   mat-icon.progress[_ngcontent-%COMP%]{font-size:18px;color:#b38600;text-align:center;height:100%}.file-parent[_ngcontent-%COMP%]   mat-icon.file-icon[_ngcontent-%COMP%]{font-size:10rem;height:15rem;width:100%;color:#555}"]}),e})(),Ve=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-shared-photo-record-display"]],inputs:{photo:"photo"},decls:16,vars:17,consts:[["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","15px",1,"fw-500"],["alt","Photo img","width","50","height","50",3,"src"],["fxLayout","column","fxLayoutAlign","center start","fxLayoutGap","5px"],[3,"title"],["target","_blank","rel","noopener noreferrer",1,"stateful",3,"href"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","5px",1,"meta"],[1,"date",3,"title"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div"),t._UZ(2,"img",1),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"a",4),t._uU(6),t.ALo(7,"stringSliceCutoff"),t.qZA()(),t.TgZ(8,"div",5)(9,"div"),t._uU(10),t.ALo(11,"fileSizeDisplay"),t.qZA(),t.TgZ(12,"div",6),t.ALo(13,"dateDisplay"),t._uU(14),t.ALo(15,"dateFromNow"),t.qZA()()()()),2&n&&(t.xp6(2),t.Q6J("src",null==i.photo?null:i.photo.photoUrl,t.LSH),t.xp6(2),t.Q6J("title",null==i.photo?null:i.photo.fileName),t.xp6(1),t.Q6J("href",null==i.photo?null:i.photo.photoUrl,t.LSH),t.xp6(1),t.hij(" ",t.xi3(7,7,null==i.photo?null:i.photo.fileName,25)," "),t.xp6(4),t.hij(" ",t.lcZ(11,10,null==i.photo?null:i.photo.fileSize)," - "),t.xp6(2),t.Q6J("title",t.xi3(13,12,null==i.photo?null:i.photo.dateUploaded,"FULLDATE")),t.xp6(2),t.hij(" ",t.lcZ(15,15,null==i.photo?null:i.photo.dateUploaded)," "))},directives:[y.xw,y.Wh,y.SQ],pipes:[k,pt.nV,J.o,J.G],styles:[".meta[_ngcontent-%COMP%]{font-size:13px}"]}),e})();function tn(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div"),t._UZ(2,"app-shared-photo-record-display",11),t.qZA(),t.BQk()),2&e){const n=o.$implicit;t.xp6(2),t.Q6J("photo",n)}}const en=function(){return["../","history"]};function nn(e,o){if(1&e&&(t.ynx(0),t.YNc(1,tn,3,1,"ng-container",6),t.TgZ(2,"div",7)(3,"a",8)(4,"div",9)(5,"div"),t._uU(6," Go to my files "),t.qZA(),t.TgZ(7,"div",10)(8,"mat-icon"),t._uU(9," arrow_right_alt "),t.qZA()()()()(),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.recentUploads),t.xp6(2),t.Q6J("routerLink",t.DdM(2,en))}}function on(e,o){1&e&&(t.ynx(0),t._uU(1," Loading... "),t.BQk())}function an(e,o){if(1&e&&(t.TgZ(0,"div",12),t.YNc(1,on,2,0,"ng-container",3),t.qZA()),2&e){const n=t.oxw(),i=t.MAs(8);t.xp6(1),t.Q6J("ngIf",n.apiWorking)("ngIfElse",i)}}function sn(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1," You have not uplaoded anything yet. \xaf\\_(\u30c4)_/\xaf "),t.qZA())}let rn=(()=>{class e{constructor(){this.recentUploads=[],this.apiWorking=!1}ngOnInit(){}ngOnChanges(n){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-main-welcome-recent-uploads"]],inputs:{recentUploads:"recentUploads",apiWorking:"apiWorking"},features:[t.TTD],decls:9,vars:2,consts:[["fxLayout","column","fxLayoutAlign","start start","fxLayoutGap","20px"],[1,"poppins","title","bb-1"],["fxLayout","column","fxLayoutGap","5px","fxLayoutAlign","start stretch"],[4,"ngIf","ngIfElse"],["noRecentPhotos",""],["loaded",""],[4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center",1,"poppins","mt-2"],[3,"routerLink"],["fxLayout","row","fxLayoutAlign","center center"],["fxLayout","column","fxLayoutAlign","center center"],[3,"photo"],[1,"poppins","gray-text","empty-text"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2," Recent uploads: "),t.qZA(),t.TgZ(3,"div",2),t.YNc(4,nn,10,3,"ng-container",3),t.qZA()(),t.YNc(5,an,2,2,"ng-template",null,4,t.W1O),t.YNc(7,sn,2,0,"ng-template",null,5,t.W1O)),2&n){const s=t.MAs(6);t.xp6(4),t.Q6J("ngIf",i.recentUploads&&i.recentUploads.length>0)("ngIfElse",s)}},directives:[y.xw,y.Wh,y.SQ,O.O5,O.sg,Ve,W.yS,H.Hw],styles:[".title[_ngcontent-%COMP%]{font-size:20px}.empty-text[_ngcontent-%COMP%]{font-size:17px}"],changeDetection:0}),e})();function ln(e,o){if(1&e&&(t.ynx(0),t._UZ(1,"app-main-welcome-recent-uploads",2),t.ALo(2,"async"),t.ALo(3,"async"),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("recentUploads",t.lcZ(2,2,n.us.userRecentUploads$))("apiWorking",t.lcZ(3,4,n.us.userFileApiWorking$))}}const cn=function(){return["/","auth","signin"]};function pn(e,o){1&e&&(t.TgZ(0,"div",3)(1,"div",4),t._uU(2," Hello! "),t.qZA(),t.TgZ(3,"div",5)(4,"div"),t._UZ(5,"img",6),t.qZA(),t.TgZ(6,"div",7)(7,"mat-icon",8),t._uU(8,"face"),t.qZA()()(),t.TgZ(9,"div",9)(10,"a",10),t._uU(11,"Create a Uploader account to get started."),t.qZA()()()),2&e&&(t.xp6(10),t.Q6J("routerLink",t.DdM(1,cn)))}let un=(()=>{class e{constructor(n){this.us=n,this.fileList=[]}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(G))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-main-welcome"]],inputs:{currentUser:"currentUser",fileList:"fileList"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noUser",""],[3,"recentUploads","apiWorking"],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","20px",1,"no-user"],[1,"poppins","main"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","10px"],["src","assets/img/uploader.png","alt","logo",1,"logo-img"],["fxLayout","row","fxLayoutAlign","center center"],[1,"welcome-icon"],[1,"poppins"],[3,"routerLink"]],template:function(n,i){if(1&n&&(t.YNc(0,ln,4,6,"ng-container",0),t.YNc(1,pn,12,2,"ng-template",null,1,t.W1O)),2&n){const s=t.MAs(2);t.Q6J("ngIf",i.currentUser)("ngIfElse",s)}},directives:[O.O5,rn,y.xw,y.Wh,y.SQ,H.Hw,W.yS],pipes:[O.Ov],styles:["[_nghost-%COMP%]{width:100%}.no-user[_ngcontent-%COMP%]   .logo-img[_ngcontent-%COMP%]{height:4rem}.no-user[_ngcontent-%COMP%]   .welcome-icon[_ngcontent-%COMP%]{font-size:4.7rem;height:4.7rem;width:4.7rem;color:#5f5dbb}.no-user[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{font-size:32px;color:#5f5dbb}.no-user[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#5f5dbb}.user[_ngcontent-%COMP%]{font-size:20px}.user[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{color:#2a2961}"]}),e})();var dn=_(7579);let Ct=(()=>{class e{constructor(){this.wholePage=!1,this.loading=!0,this.logoShakeState=!1,this.compDest$=new dn.x}ngOnChanges(n){this.parentClass=this.wholePage?"whole-page loading-container":"container loading-container mt-5"}ngOnInit(){}ngOnDestroy(){this.compDest$.next(null),this.compDest$.complete()}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-shared-loading"]],inputs:{wholePage:"wholePage",message:"message"},features:[t.TTD],decls:12,vars:3,consts:[["fxLayout","column","fxLayoutAlign","center center",1,"w-100"],[1,""],[1,"loading-logo"],["src","assets/img/uploader.png","alt","logo",1,"logo-img","d-inline-block"],[1,"loading-parent"],[1,"lds-facebook"],[1,"secfont"]],template:function(n,i){1&n&&(t.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"div",2),t._UZ(4,"img",3),t.qZA()(),t.TgZ(5,"div",4)(6,"div",5),t._UZ(7,"div")(8,"div")(9,"div"),t.qZA()(),t.TgZ(10,"div",6),t._uU(11),t.qZA()()()),2&n&&(t.Tol(i.parentClass),t.xp6(11),t.hij(" Loading ",i.message," ... "))},directives:[y.xw,y.Wh],styles:[".loading-logo[_ngcontent-%COMP%]{height:3rem}.loading-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%}.loading-parent[_ngcontent-%COMP%]{justify-content:center;align-items:center}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}.whole-page[_ngcontent-%COMP%]{position:fixed;width:100%}.lds-facebook[_ngcontent-%COMP%]{display:inline-block;position:relative;width:80px;height:80px}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:inline-block;position:absolute;left:8px;width:16px;background:#007bff;animation:lds-facebook 1.2s cubic-bezier(0,.5,.5,1) infinite}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(1){left:8px;animation-delay:-.24s}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){left:32px;animation-delay:-.12s}.lds-facebook[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){left:56px;animation-delay:0}@keyframes lds-facebook{0%{top:8px;height:64px}50%,to{top:24px;height:32px}}"]}),e})();const gn=["uploadInput"];function fn(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",17),t._uU(2),t.qZA(),t.TgZ(3,"div",18)(4,"mat-icon",19),t._uU(5,"task_alt"),t.qZA()(),t.BQk()),2&e){const n=t.oxw().ngIf;t.xp6(2),t.AsE(" ",n.uploadings.length," / ",n.total.length," files uploaded ")}}function mn(e,o){if(1&e&&(t.TgZ(0,"div",17),t._uU(1),t.qZA(),t.TgZ(2,"mat-icon",20),t._uU(3,"hourglass_bottom"),t.qZA()),2&e){const n=t.oxw().ngIf;t.xp6(1),t.AsE(" Uploading: ",n.uploadings.length," / ",n.total.length," ")}}function _n(e,o){if(1&e&&(t.ynx(0),t.YNc(1,fn,6,2,"ng-container",0),t.ALo(2,"async"),t.YNc(3,mn,4,2,"ng-template",null,16,t.W1O),t.BQk()),2&e){const n=t.MAs(4),i=t.oxw(4);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,i.fs.isFilesUploadFinished$))("ngIfElse",n)}}function hn(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",21),t._UZ(2,"app-upload-item",22),t.qZA(),t.BQk()),2&e){const n=o.$implicit;t.xp6(2),t.Q6J("file",n)}}function yn(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",10)(2,"div",12)(3,"div",13),t.YNc(4,_n,5,4,"ng-container",9),t.ALo(5,"async"),t.qZA()(),t.TgZ(6,"section",14),t.YNc(7,hn,3,1,"ng-container",15),t.qZA()(),t.BQk()),2&e){const n=t.oxw().ngIf,i=t.oxw(2);t.xp6(4),t.Q6J("ngIf",t.lcZ(5,3,i.fs.uploadingsAndTotalFiles$)),t.xp6(3),t.Q6J("ngForOf",n)("ngForTrackBy",i.trackById)}}function xn(e,o){if(1&e&&(t.ynx(0),t.YNc(1,yn,8,5,"ng-container",9),t.BQk()),2&e){const n=o.ngIf;t.xp6(1),t.Q6J("ngIf",n.length>0)}}function Un(e,o){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",2)(2,"input",3,4),t.NdJ("change",function(s){return t.CHM(n),t.oxw().onFileInputClick(s)}),t.qZA()(),t.TgZ(4,"div",5)(5,"div",6),t.NdJ("click",function(){return t.CHM(n),t.oxw().onFileUpload()}),t.TgZ(6,"div",7),t._uU(7," Select items to upload "),t.qZA(),t.TgZ(8,"div")(9,"button",8),t.ALo(10,"async"),t.TgZ(11,"mat-icon"),t._uU(12,"add"),t.qZA()()()(),t.YNc(13,xn,2,1,"ng-container",9),t.ALo(14,"async"),t.TgZ(15,"div",10),t._UZ(16,"app-main-welcome",11),t.ALo(17,"async"),t.qZA()(),t.BQk()}if(2&e){const n=t.oxw();t.xp6(9),t.Q6J("disabled",!t.lcZ(10,3,n.as.currentUser$)),t.xp6(4),t.Q6J("ngIf",t.lcZ(14,5,n.fs.filesUploadingAll$)),t.xp6(3),t.Q6J("currentUser",t.lcZ(17,7,n.as.currentUser$))}}function vn(e,o){1&e&&(t.TgZ(0,"div",10),t._UZ(1,"app-shared-loading"),t.qZA())}function On(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"div",2)(2,"div",3)(3,"div",4)(4,"div"),t._uU(5," My Files "),t.qZA(),t.TgZ(6,"div"),t._uU(7),t.ALo(8,"async"),t.qZA()(),t._UZ(9,"hr",5),t.qZA()(),t.BQk()),2&e){const n=t.oxw();t.xp6(7),t.hij(" (",t.lcZ(8,1,n.fs.userFilesCount$),") ")}}function Ln(e,o){1&e&&(t.TgZ(0,"div",5),t._UZ(1,"app-shared-loading"),t.qZA())}const Cn=[{path:"",component:St,children:[{path:"",redirectTo:"upload",pathMatch:"full"},{path:"upload",component:(()=>{class e{constructor(n,i,s,a,p){this.fs=n,this.rs=i,this.as=s,this.ts=a,this.pss=p}ngOnInit(){this.pss.getProgressSnackbar({fileStatus:this.fs.filesUploadingAll$,isFilesUploadFinished:this.fs.isFilesUploadFinished$,uploadingsAndTotalFiles:this.fs.uploadingsAndTotalFiles$})}onFileUpload(){var n;const i=null===(n=this.uploadInput)||void 0===n?void 0:n.nativeElement;i&&this.as.currentUser$.pipe((0,Y.q)(1)).subscribe(s=>{s?i.click():this.ts.openSingletonToast("warning","You are not logged in.")})}onFileInputClick(n){var i;const s=null===(i=n.target)||void 0===i?void 0:i.files;s&&(this.fs.cleanUpAttachedFiles(),Object.keys(s).forEach(p=>{this.fs.attachFile(s[p],(new Date).getTime()+p+"")}))}trackById(n,i){return i.id}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(G),t.Y36(at),t.Y36(q.e),t.Y36(Lt.q),t.Y36(Qe))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-main-all"]],viewQuery:function(n,i){if(1&n&&t.Gf(gn,5),2&n){let s;t.iGM(s=t.CRH())&&(i.uploadInput=s.first)}},decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,""],["type","file","multiple","",1,"upload-input",3,"change"],["uploadInput",""],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","30px",1,"w-100"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","15px",1,"quicksand","upload-action",3,"click"],[1,"text"],["mat-fab","","color","primary","aria-label","Upload files",3,"disabled"],[4,"ngIf"],[1,"w-100"],[3,"currentUser"],[1,"uploading-title","quicksand","fw-500"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","5px",1,""],["fxLayout","row wrap","fxLayoutAlign","start center","fxLayoutGap","15px",1,"w-100"],[4,"ngFor","ngForOf","ngForTrackBy"],["uploading",""],[1,"bb-1"],["fxLayout","column","fxLayoutAlign","center center",1,""],[1,"text-success"],[1,"text-primary"],["fxFlex.gt-sm","23","fxFlex","100"],[3,"file"]],template:function(n,i){if(1&n&&(t.YNc(0,Un,18,9,"ng-container",0),t.ALo(1,"async"),t.YNc(2,vn,2,0,"ng-template",null,1,t.W1O)),2&n){const s=t.MAs(3);t.Q6J("ngIf",!1===t.lcZ(1,2,i.as.apiLoading$))("ngIfElse",s)}},directives:[O.O5,y.xw,y.Wh,y.SQ,ct.lW,H.Hw,O.sg,y.yH,Xe,un,Ct],pipes:[O.Ov],styles:[".upload-action[_ngcontent-%COMP%]{border:1px solid #ccc;padding:5px 25px;border-radius:30px;background-color:#e6f2ff;cursor:pointer}.upload-action[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:20px;color:#5f5dbb}.upload-input[_ngcontent-%COMP%]{display:none;height:0px}.uploading-title[_ngcontent-%COMP%]{font-size:20px}"]}),e})(),data:{pageTitle:"Upload Files"}},{path:"history",component:(()=>{class e{constructor(n,i,s,a){this.fs=n,this.rs=i,this.as=s,this.ts=a}ngOnInit(){this.fs.getUserFiles()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(G),t.Y36(at),t.Y36(q.e),t.Y36(Lt.q))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-main-history"]],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["loading",""],["fxLayout","column","fxLayoutAlign","start center","fxLayoutGap","45px",1,"w-100"],[1,"title","quicksand","fw-500","w-100"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","5px"],[1,"w-100"]],template:function(n,i){if(1&n&&(t.YNc(0,On,10,3,"ng-container",0),t.ALo(1,"async"),t.YNc(2,Ln,2,0,"ng-template",null,1,t.W1O)),2&n){const s=t.MAs(3);t.Q6J("ngIf",!1===t.lcZ(1,2,i.fs.userFilesApiLoading$))("ngIfElse",s)}},directives:[O.O5,y.xw,y.Wh,y.SQ,Ct],pipes:[O.Ov],styles:[".title[_ngcontent-%COMP%]{font-size:20px}"]}),e})(),data:{pageTitle:"My Files"}}]}];let Tn=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[W.Bz.forChild(Cn)],W.Bz]}),e})();var Tt=_(3900),Pn=_(9770),$=_(9646),Mn=_(1884),Fn=_(6556);let In=(()=>{class e{constructor(n,i,s){this.actions$=n,this.us=i,this.as=s,this.getUserFiles$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(z,ot),(0,v.IC)(()=>this.as.currentUser$),(0,M.U)(a=>a[1]),(0,Tt.w)(a=>function Zn(e,o,n){return(0,Pn.P)(()=>e()?o:n)}(()=>!!a,this.us.getUserPhotos(null==a?void 0:a.email).pipe((0,M.U)(p=>ht({files:p})),(0,R.K)(p=>(0,$.of)(jt({errMsg:(0,Fn.S)(p)})))),(0,$.of)(yt()))))),this.userChange$=(0,v.GW)(()=>this.as.currentUser$.pipe((0,Mn.x)((a,p)=>(null==a?void 0:a.email)===(null==p?void 0:p.email)),(0,Tt.w)(a=>(0,$.of)(z({user:a})))))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(v.eX),t.LFG(G),t.LFG(q.e))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();var Pt=_(5577),ut=_(8746),Zt=_(9300),Sn=_(7272);const wn=[(()=>{class e{constructor(n,i,s){this.actions$=n,this.us=i,this.as=s,this.attachFileForUpload$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(gt),(0,M.U)(a=>V({fileId:a.fileId,file:a.file})))),this.uploadFileStart$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(V),(0,Pt.z)(a=>{var p;const U=a.fileId,T=a.file,S=null!==(p=T.name)&&void 0!==p?p:"File-name-"+(new Date).getTime(),F=(new Date).getTime(),P=this.us.uploadFile(T,S);let w=[P.task.percentageChanges().pipe((0,M.U)(L=>({fileId:U,percent:L})),(0,ut.x)(()=>{})),P.ref.getDownloadURL().pipe((0,M.U)(L=>({fileId:U,url:L})),(0,ut.x)(()=>{}))];return(0,Sn.z)(...w).pipe((0,M.U)(L=>{var D;const m=null!==(D=L.percent)&&void 0!==D?D:L.url?100:L.percent;return et({fileId:U,fileName:S,fileSize:a.file.size,uploadDate:F,downloadUrl:L.url,progress:m})}),(0,R.K)(L=>(console.error("Upload Error!"+L),(0,$.of)(mt({errMsg:L})))),(0,ut.x)(()=>{}))}))),this.uploadFileFinished$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(et),(0,Zt.h)(a=>!(!a.downloadUrl||100!==a.progress)),(0,M.U)(a=>tt({fileId:a.fileId,fileName:a.fileName,fileSize:a.fileSize,uploadDate:a.uploadDate,downloadUrl:a.downloadUrl})))),this.updateUserPhotoDatabaseAfterUploadSuccess$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(tt),(0,M.U)(a=>nt({photoData:{id:a.fileId,dateUploaded:a.uploadDate,fileId:a.fileId,fileName:a.fileName,fileSize:a.fileSize,photoUrl:a.downloadUrl}})))),this.updateUserPhotoDatabase$=(0,v.GW)(()=>this.actions$.pipe((0,v.l4)(nt),(0,v.IC)(()=>this.as.currentUser$),(0,Zt.h)(a=>{var p;return!!(null===(p=a[1])||void 0===p?void 0:p.email)}),(0,Pt.z)(a=>{var p;const U=null===(p=a[1])||void 0===p?void 0:p.email,S=this.us.addPhotoUrl(a[0].photoData,U).operationObs,F=a[0].photoData.id;return S.then(P=>{const w=Object.assign(Object.assign({},a[0].photoData),{id:F});return ot({photoData:w})}).catch(P=>_t({errMsg:P}))})))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(v.eX),t.LFG(G),t.LFG(q.e))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})()],En=(0,l.Lq)({isSnackbarShown:!0,progressDialogDisplay:void 0}),kn=[(()=>{class e{constructor(n){this.actions$=n}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(v.eX))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})()];let Nn=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[],imports:[[It.n,Mt.I,Ft.d,l.Aw.forFeature(xt,ee),l.Aw.forFeature(Ut,pe),l.Aw.forFeature("uploadProgressDialogSnackbar",En),v.sQ.forFeature(wn),v.sQ.forFeature([In]),v.sQ.forFeature(kn),X.TE,Tn]]}),e})()}}]);